---
title: "spammR: Spatial Analysis of Multiomics Measurements in R"
author:
- name: Harkirat Sohi
  affiliation: Pacific Northwest National Laboratory
- name: Sara Gosline
  affiliation: Pacific Northwest National Laboratory
  email: sara.gosline@pnnl.gov
package: spammR
output:
  BiocStyle::html_document
abstract: |
  A basic walkthrough of how to use and analyzie spatial multiomics measurements in the spammR package
vignette: |
  %\VignetteIndexEntry{spammR}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---

# Getting started

To install the package currently you must install directly from `GitHub` along with the leapR dependency as shown below.
```
library(devtools)
devtools::install_github('PNNL-CompBio/leapR')
devtools::install_github('PNNL-CompBio/spammR')
```

Once the package is installed you can begin to evaluate the functionality. 

# Pancreatic spatial proteomic measurements

To evaluate the features of this package we are using pancreatic data from [Gosline et al.]() that is captured using mass spectrometry measused from 7 independent regions of a single human pancreas. Each image is segemented into nine 'voxels', with one voxel per image representing a cluster of islet cells. 

# Loading data into SpatialExperiment object

We first include functionality to load the data into a `SpatialExperiment` object. This includes creating a careful metadata file with each protomic spot coordinate in the image.  

```{r load data}

```

# Differential Expression

# Distance based measurements



# Plotting with image data

Currently we are loading all data into the same object to evaluate the images together. However, we can also evaluate the images case by case to visualize the expression togehter with the image information.

First we need to load in the images 
## Spatial data with image
```{r spatial data}
imglist=c('Image_0','Image_1','Image_2','Image_3','Image_4')

allres=lapply(imglist,
              function(x){
                convert_to_spe(pancDataList[[x]],pancMeta,protMeta,
                              feature_meta_colname='pancProts',spatialCoords_colnames=c('x_pixels','y_pixels'),
                              image_files=system.file('extdata',paste0(x,'.png'),package='spammR'),
                              image_samples_common_identifier=x,
                              samples_common_identifier = x,
                              image_ids='with_grid')
              })
names(allres)<- imglist
```

## Plot heatmap
Now that we have this data we can begin to plot the values. Since this is pancreatic data, we focus on the expression of the Insulin protein `INS`. 

```{r do ploting}


```
# References {.unnumbered}

1. Gosline et al.
2. Spatial Experiment

# Session info

```{r sessionInfo, echo=FALSE}
sessionInfo()
```
