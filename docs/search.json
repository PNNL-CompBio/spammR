[{"path":"/articles/lipidProt.html","id":"about","dir":"Articles","previous_headings":"","what":"About","title":"spammR lipidomic and proteomic integration","text":"goal vignette showcase integration two different omes spatial context. use dataset sections rat brain measured via mass spetrometry imaging (MSI) identify lipidomic measurements alongside proteomics regions interest Vandergrift et al. show spammR enables: - download loading datasets - visualization features within dataset - identification correlated regions dataset First load required packages.","code":""},{"path":"/articles/lipidProt.html","id":"load-proteomics-data","dir":"Articles","previous_headings":"","what":"Load proteomics data","title":"spammR lipidomic and proteomic integration","text":"proteomics data can found zenodo downloaded directly. .","code":""},{"path":"/articles/lipidProt.html","id":"format-data","dir":"Articles","previous_headings":"Load proteomics data","what":"Format data","title":"spammR lipidomic and proteomic integration","text":"require formatting data matrix loading. image downloaded separately metaspace (see ) stored package. Now image loaded can visualize (done save space) verify expect. can see, squares chopped image. samples measured via proteomics. next step map coordinates can compare MSI data.","code":"#brain data finame <- paste0('https://zenodo.org/records/13345212/files/DESI+spatial',                  '%20proteomics%20rat%20brain%20proteomics%20',                  'result.xlsx?download=1') fi <- download.file(finame,                     dest = 'dat.xlsx')  #read in data, convert to matrix  dat <- readxl::read_xlsx('dat.xlsx')   feature_data <- select(dat, c(Protein,`Protein ID`,`Entry Name`,Gene)) |>   dplyr::distinct() |>   tibble::column_to_rownames('Protein')  dat <- select(dat, c(Protein, starts_with('ROI'))) |>   tibble::column_to_rownames('Protein') ##read in image img <- system.file(\"extdata\",\"brain_img_0.png\",package = 'spammR') cowplot::ggdraw() + cowplot::draw_image(system.file(\"extdata\",                                                     \"brain_img_0.png\",                                                     package = \"spammR\"))"},{"path":"/articles/lipidProt.html","id":"loading-image-coordinates-rom-geojson","dir":"Articles","previous_headings":"Load proteomics data","what":"Loading image coordinates rom GEOJson","title":"spammR lipidomic and proteomic integration","text":"used program [QuPath][(https://qupath.readthedocs.io/en/stable/) collect regions interest (ROI) coordinates image. program allowed us highlight regions interest export GEOJson format, can used input spammR. store GEOJson file package load example choose load teo GEOJson using geojsonR package. avoid just load csv directly: Now coordinates can use spammR create SpatialExperiment object plot protein.","code":"#remove this once we can include it in spammR     library(geojsonR)   jsondat <- FROM_GeoJson(system.file('extdata','brain_roi.geojson',                                       package = 'spammR'))     ##herr er hry yhr   coords <- do.call(rbind, lapply(jsondat$features,function(x){      roi <- x$properties$name      xv <- x$geometry$coordinates[,1]      yv <- x$geometry$coordinates[,2]      if (is.null(roi))         roi = \"\"      return(list(ID = roi, x_pixels = min(xv), y_pixels = min(yv),                   spot_height = max(yv) - min(yv),                  spot_width = max(xv) - min(xv)))      })) |>      as.data.frame() |>      subset(ID != \"\") |>      tidyr::separate(ID,into = c('ROI','Replicate'),                       sep = '_',                       remove = FALSE) |>      tibble::remove_rownames() |>      tibble::column_to_rownames('ID')    ##now for each ROI we want an x, y, cell height and cell_width  #y-coordinates are from top, so need to udpate   coords$y_pixels = 263 - unlist(coords$y_pixels) - unlist(coords$spot_height)   coords$x_pixels = unlist(coords$x_pixels)   coords$spot_height = unlist(coords$spot_height)   coords$spot_width = unlist(coords$spot_width)   readr::write_csv(as.data.frame(coords),file='../inst/extdata/bcoords.csv') coords <- read.csv(system.file('extdata','bcoords.csv',                                package = 'spammR')) rownames(coords) <- paste(coords$ROI, coords$Replicate,sep = '_')"},{"path":"/articles/lipidProt.html","id":"create-spatialexperiment-object","dir":"Articles","previous_headings":"Load proteomics data","what":"Create SpatialExperiment Object","title":"spammR lipidomic and proteomic integration","text":"load proteomics create object.  protein data collected smaller regions interest within larger image.","code":"#create an SFE   spe <- spammR::convert_to_spe(dat = dat,                        feature_meta = feature_data,                       sample_meta = coords,                       spatial_coords_colnames = c('x_pixels','y_pixels'),                       assay_name = 'proteomics',                       sample_id = 'rat_brain',                        image_files = img,                       image_id = 'rat_brain')    # myelin   spammR::spatial_heatmap(spe, feature = 'Mbp',                            feature_type = 'Gene',                 sample_id = 'rat_brain',                  image_id = 'rat_brain')"},{"path":"/articles/lipidProt.html","id":"load-lipidomics-data","dir":"Articles","previous_headings":"","what":"Load lipidomics data","title":"spammR lipidomic and proteomic integration","text":"Now image protein data loaded, can begin ingest lipid data metaspace. requires additional command pull information directly.","code":""},{"path":"/articles/lipidProt.html","id":"retrieve-metaspace-data","dir":"Articles","previous_headings":"Load lipidomics data","what":"Retrieve metaspace data","title":"spammR lipidomic and proteomic integration","text":"created wrapper Metaspace python package enable download formatting metaspace measurements spammR. result SpatialExperiment. takes long run vignette show code load file separately. Now can downlod object figshare load . Lastly add image file data downloaded metaspace visualize lipid interest.  can see overlay specific lipids.","code":"##get lipid data from metaspace   mspe <- spammR::retrieve_metaspace_data(\"2024-02-15_20h37m13s\",                                  fdr = 0.2,                                  assay_name = 'lipids',                                 sample_id = 'rat_brain',                                 rotate = TRUE,                                  drop_zeroes = TRUE) download.file('https://api.figshare.com/v2/file/download/60993349',               destfile = 'mspe.rds') mspe <- readRDS('mspe.rds') file.remove('mspe.rds') ## [1] TRUE ## add in image to check  mspe <- SpatialExperiment::addImg(mspe, img, scaleFactor = NA_real_,                                   sample_id = 'rat_brain',                                   image_id = 'rat_brain')  meta <- rowData(mspe)  meta$Name <- vapply(meta$moleculeNames, function(x) {  x[1]}, character(1))  rowData(mspe) <- meta  spatial_heatmap(mspe, feature = 'C41H78NO7P-H-',                  assay = 'lipids',                  plot_log = TRUE,                    metric_display = 'Lipid expression',                 sample_id = 'rat_brain',                 image_id = 'rat_brain')#plot with an ion ## Warning: Removed 17673 rows containing missing values or values outside the scale range ## (`geom_label()`)."},{"path":"/articles/lipidProt.html","id":"merging-images-to-single-coordinate-system","dir":"Articles","previous_headings":"Load lipidomics data","what":"Merging images to single coordinate system","title":"spammR lipidomic and proteomic integration","text":"Since proteomics measured discrete ROI lipids measured per-pixel basis, carry pure multiomic comparisons need map coordinate space. use spat_reduce function reduce lipidomics data regions proteomics.  Now can start analyze relationship lipids proteins. # Correlation analysis One innovative analyses can spatial data evaluate correlations within molecules across space. include spatial_network function can compute correlations groups features across omic domains show use .","code":""},{"path":"/articles/lipidProt.html","id":"ascribing-function-to-unknown-lipids","dir":"Articles","previous_headings":"Load lipidomics data","what":"Ascribing function to unknown lipids","title":"spammR lipidomic and proteomic integration","text":"can use correlation analysis assess biological function specific lipids, seeking pathways -represented among proteins correlated lipid interest.","code":""},{"path":"/articles/lipidProt.html","id":"protein-correlations","dir":"Articles","previous_headings":"Load lipidomics data > Ascribing function to unknown lipids","what":"Protein correlations","title":"spammR lipidomic and proteomic integration","text":"Let’s see lipids variable across tissue. ’ll focus phosphatidylserin “PS(28:6(10Z,13Z,16Z,19Z,22Z,25Z)/12:0)”, variable across sample.   Now can ask proteins correlate lipid reduced object.  Now correlation value - negative positive - can use input functional enrichment test.","code":"lvs <- sort(apply(assay(mspe,'lipids'),1,var,na.rm = TRUE),decreasing = TRUE)[1:10]  lvn <- rowData(altExp(reduced))[names(lvs),'Name']  lvn[3] ## [1] \"PI(18:1(11Z)/20:3(8Z,11Z,14Z))\" #number 1 seems to have an interesting pattern spatial_heatmap(mspe,feature = lvn[1], assay_name = 'lipids',                  feature_type = 'Name',                 image_id = 'rat_brain', sample_id = 'rat_brain',                  metric_display = 'Lipid expression',                 plot_log = TRUE) ## Warning: Removed 68794 rows containing missing values or values outside the scale range ## (`geom_label()`). spatial_heatmap(reduced,feature = lvn[1], assay_name = 'lipids',                  feature_type = 'Name',                 image_id = 'rat_brain', sample_id = 'rat_brain',                  metric_display = 'Lipid expression',                 plot_log = TRUE) ## Warning: Removed 25 rows containing missing values or values outside the scale range ## (`geom_label()`). #let's look at the correlation between the lipid and proteins fl <- c(lvn[1], rowData(reduced)[,'Gene'])   cg <- spatial_network(reduced,                        assay_names = c(\"proteomics\",\"lipids\"),                        query_features = lvn[1], #lipid                       target_features = rowData(reduced)[,'Gene'],                       feature_names = c('Gene','Name')) ## Joining with `by = join_by(rowval)` ##we can then use trick above to get the neighborhood of our lipid gt <- cg %>%   activate(nodes) |>   as_tibble()  neigh_weights <-  cg |>   activate(edges) |>   filter(from == which(gt$name == lvn[1]))   #then we can get the edge weights and nodes  edges <- neigh_weights |> as_tibble()  nodes <- neigh_weights |>   activate(nodes) |>   as_tibble()  ##create a table with the protein correlationm prot_cor <- data.frame(nodes[edges$to,],lipid_cor = edges$corval) |>   dplyr::rename(Gene = 'name') |>   subset(Gene %in% rowData(reduced)[,'Gene'])  neigh_weights |>   activate(edges) |> filter(abs(corval) > 0.75) |>   activate(nodes) |>   mutate(degree = centrality_degree(mode = 'all')) |>   filter(degree > 0) |>   ggraph(layout = 'stress')  +   geom_edge_link(aes(colour = corval)) +    geom_node_point(aes(color = class)) +   geom_node_label(aes(label = name, color = class))"},{"path":"/articles/lipidProt.html","id":"functional-enrichment","dir":"Articles","previous_headings":"Load lipidomics data > Ascribing function to unknown lipids","what":"Functional enrichment","title":"spammR lipidomic and proteomic integration","text":"can look pathway enriched correlation values using leapR via enrichment_in_order method. can now look pathways statistically significant.","code":"##add back to data set  prot_cor <- prot_cor |>    group_by(Gene) |>    summarize(lipid_cor = mean(lipid_cor))  rowData(reduced) <- rowData(reduced) |>   as.data.frame() |>   left_join(prot_cor) |>   mutate(upperGene = toupper(Gene)) ## Joining with `by = join_by(Gene)` data(\"krbpaths\") enrich <- leapR::leapR(geneset = krbpaths, enrichment_method = 'enrichment_in_order',                        eset = reduced, primary_column = 'lipid_cor',                         id_column = 'upperGene', minsize = 5)   paths <- subset(enrich, BH_pvalue < 0.3) #subset(enrich,ingroup_mean > 0.25) |>  #  subset(pvalue <0.05)  print(paths) ##                                                 ingroup_n ## KEGG_ALANINE_ASPARTATE_AND_GLUTAMATE_METABOLISM        20 ##                                                                                                                                                            ingroupnames ## KEGG_ALANINE_ASPARTATE_AND_GLUTAMATE_METABOLISM GOT2, ASS1, GLUL, GLUD1, GOT1, GLS, GAD1, ASL, GPT, PPAT, ASNS, ABAT, GFPT1, GAD2, ACY3, ASPA, ALDH5A1, ADSL, NIT2, CAD ##                                                 ingroup_mean outgroup_n ## KEGG_ALANINE_ASPARTATE_AND_GLUTAMATE_METABOLISM    0.2539142       5040 ##                                                 outgroup_mean   zscore ## KEGG_ALANINE_ASPARTATE_AND_GLUTAMATE_METABOLISM   0.003796164 0.728826 ##                                                 oddsratio       pvalue ## KEGG_ALANINE_ASPARTATE_AND_GLUTAMATE_METABOLISM 0.3849837 7.634525e-05 ##                                                  BH_pvalue SignedBH_pvalue ## KEGG_ALANINE_ASPARTATE_AND_GLUTAMATE_METABOLISM 0.04481466      0.04481466 ##                                                 background_n background_mean ## KEGG_ALANINE_ASPARTATE_AND_GLUTAMATE_METABOLISM           NA              NA"},{"path":"/articles/lipidProt.html","id":"plot-proteins","dir":"Articles","previous_headings":"Load lipidomics data > Ascribing function to unknown lipids","what":"Plot proteins","title":"spammR lipidomic and proteomic integration","text":"first check expression proteins well see correlated direction. can see negative correlated.  heatmap confirms lipid interest indeed associated glucose suger transporter pathway.","code":"prots <- unlist(stringr::str_split(paths[1,'ingroupnames'], pattern = ', '))  pv <- assay(subset(reduced,upperGene %in% prots),'proteomics') lv <- assay(subset(altExp(reduced),Name == lvn[1]),'lipids')   ##proteins seem anti-correlated mean(cor(t(pv),t(lv), method = 'spearman')) ## [1] -0.2047532 p2 <- spatial_heatmap(reduced, assay_name = 'proteomics',                 feature = prots,                 feature_type = 'upperGene',                 sample_id = 'rat_brain',                 image_id = 'rat_brain',                  plot_log = TRUE,                  title_size = 10,                 plot_title = rownames(paths)[1],                 metric_display = 'Protein expression')   p2 ## Warning: Removed 25 rows containing missing values or values outside the scale range ## (`geom_label()`)."},{"path":"/articles/lipidProt.html","id":"summary","dir":"Articles","previous_headings":"","what":"Summary","title":"spammR lipidomic and proteomic integration","text":"vignette explores one can use spammR package analyze multiomics measurements captured spatial context.","code":""},{"path":"/articles/spatMicrobiome.html","id":"r-and-other-dependencies","dir":"Articles","previous_headings":"","what":"R and other dependencies","title":"spammR microbiome evaluation","text":"require packages mapping requirements beyond basic spammR tools. following R packages required: - spammR - sf relies non R-libraries (see Installing details install sf including dependencies) following non-R packages may required: - GEOS - PROJ - GDAL","code":"library(spammR) library(ggplot2) library(tibble) library(magrittr) library(dplyr) ## these two libraries are only used for geographic data library(sf) library(terra)"},{"path":"/articles/spatMicrobiome.html","id":"metagenomic-data-formatting-requirements","dir":"Articles","previous_headings":"","what":"Metagenomic data formatting requirements","title":"spammR microbiome evaluation","text":"data working KEGG ortholog enrichment 1000 soils project. 1000 soils project nice feature location two sampling different depths (‘top’ ‘bottom’). use circumstance combination KO enrichment generate pathway enrichment sample location depth visualize differential two depths. downloaded 1000 soil data stored two separate files can loaded directly package. first file actual KO measurements. can create metadata file KO metadata table contain mapping KO identifier - row names Omics Measurement table - descriptive annotation.testing purposes currently row names & incremented integer values. Next need import lat/long information locations 1000 soil project samples extracted. file retrieved 1000 Soils Project Shiny App. metadata retrieved using Query>Information tab. left side (“Information Menu”) select SAMPLE_ID, latitude & longitude download resulting mapping. Sample_ID entries complete lat/long data. generate sf object (see ) needed input create terra:SpatRaster object input table can contain complete cases (.e. NaN values). sample metadata contains information type Biome, layer soil sample (‘top’ ‘bottom’), pH, example, well coordinates.","code":"## [1] TRUE oneKSoilsOmicsMeta <- data.frame(KO = character(nrow(oneKSoilsData)))  oneKSoilsOmicsMeta[\"KO\"] <- rownames(oneKSoilsData) oneKSoilsOmicsMeta[\"annotation\"] <- seq(1, by = 1,                                          length.out = nrow(oneKSoilsOmicsMeta)) oneKSoilsOmicsMeta[\"annotation\"] <- lapply(oneKSoilsOmicsMeta[\"annotation\"],                                             as.character) head(oneKSoilsOmicsMeta) ##       KO annotation ## 1 K00001          1 ## 2 K00002          2 ## 3 K00003          3 ## 4 K00004          4 ## 5 K00005          5 ## 6 K00006          6 data(\"oneKSoilsMeta\") head(oneKSoilsMeta) ##   Sample_ID Site_Code Core_Layer latitude  longitude Elev.m Soil.Temperature.C ## 1  ANZA_TOP      ANZA        TOP 33.30533 -116.25401    191               42.7 ## 2  ANZA_BTM      ANZA        BTM 33.30533 -116.25401    191               42.7 ## 3  BLAN_TOP      BLAN        TOP 39.05941  -78.07207    174               19.7 ## 4  BLAN_BTM      BLAN        BTM 39.05941  -78.07207    174               19.7 ## 5  CFS1_TOP      CFS1        TOP 35.38280  -78.03818     24               18.5 ## 6  CFS1_BTM      CFS1        BTM 35.38280  -78.03818     24               18.5 ##   VolWaterContent.m3.m3   pH K_mg_per_kg SO4.S_mg_per_kg B_mg_per_kg ## 1                0.0490 8.75         107               4        0.25 ## 2                0.0490 9.20          82               4        0.20 ## 3                0.1740 6.50         189              10        0.42 ## 4                0.1740 5.92         122              19        0.27 ## 5                0.0515 6.66         231              NA          NA ## 6                0.0515 6.98         107               6        0.26 ##   Zn_mg_per_kg Mn_mg_per_kg Cu_mg_per_kg Fe_mg_per_kg Ca_Meq_per_100_g ## 1          0.2          1.9          0.1           13             3.27 ## 2          0.3          1.1          0.1           14             3.05 ## 3          0.7         28.3          0.7           54             5.47 ## 4          0.2         15.9          0.5           16             4.31 ## 5           NA           NA           NA           NA             2.41 ## 6          0.3          0.7          0.5           18             2.93 ##   Mg_Meq_per_100_g Na_Meq_per_100_g BIOME                          biome_name ## 1             0.26             0.10    13          Deserts & Xeric Shrublands ## 2             0.42             0.08    13          Deserts & Xeric Shrublands ## 3             0.81             0.05     4 Temperate Broadleaf & Mixed Forests ## 4             0.57             0.06     4 Temperate Broadleaf & Mixed Forests ## 5             0.68             0.08     5           Temperate Conifer Forests ## 6             1.14             0.06     5           Temperate Conifer Forests ggplot2::ggplot(oneKSoilsMeta, aes(x = Core_Layer, y = pH, fill = biome_name)) +   geom_boxplot() ## Warning: Removed 4 rows containing non-finite outside the scale range ## (`stat_boxplot()`)."},{"path":"/articles/spatMicrobiome.html","id":"geographic-map-formatting-requirements","dir":"Articles","previous_headings":"","what":"Geographic map formatting requirements","title":"spammR microbiome evaluation","text":"Maps can downloaded public repositories ‘shape’ file can processed coordinates visualization. show retrieve shape file d US Census Bureau following parameters: Year = 2024 Layer type = “States (equivalent)” downloaded zip file [census FTP site] (https://www2.census.gov/geo/tiger/TIGER2024/STATE/). code chunk executed displayed example load downloaded shape file using sf package. Instead load file supplied rda file: map contains entire US, visualization purposes focus continental US. Now coordinate information need convert pixels using terra package, requires creating rasterization template using ” terra::SpatRaster. object can generate rasterized image retaining location information ability project map different map projection. terra package can read shape file follows: create rasterized landmass continental US:","code":"us_map <- sf::st_read(\"../data/tl_2024_us_state/tl_2024_us_state.shp\",                        quiet = TRUE) us_map ## [1] TRUE us_continental <- c(   \"WV\", \"FL\", \"IL\", \"MN\", \"MD\", \"RI\", \"ID\", \"NH\", \"NC\", \"VT\",   \"CT\", \"DE\", \"NM\", \"CA\", \"NJ\", \"WI\", \"OR\", \"NE\", \"PA\", \"WA\",   \"LA\", \"GA\", \"AL\", \"UT\", \"OH\", \"TX\", \"CO\", \"SC\", \"OK\", \"TN\",   \"WY\", \"ND\", \"KY\", \"ME\", \"NY\", \"NV\", \"MI\", \"AR\", \"MS\", \"MO\",   \"MT\", \"KS\", \"IN\", \"SD\", \"MA\", \"VA\", \"DC\", \"IA\", \"AZ\" )  s_us_cont <- us_map %>%   .[.$STUSPS %in% us_continental, ] %>%   vect() s_us_cont ##  class       : SpatVector  ##  geometry    : polygons  ##  dimensions  : 49, 15  (geometries, attributes) ##  extent      : -124.849, -66.88544, 24.39631, 49.38448  (xmin, xmax, ymin, ymax) ##  coord. ref. : lon/lat NAD83 (EPSG:4269)  ##  names       : REGION DIVISION STATEFP  STATENS GEOID     GEOIDFQ STUSPS ##  type        :  <chr>    <chr>   <chr>    <chr> <chr>       <chr>  <chr> ##  values      :      3        5      54 01779805    54 0400000US54     WV ##                     3        5      12 00294478    12 0400000US12     FL ##                     2        3      17 01779784    17 0400000US17     IL ##           NAME  LSAD MTFCC (and 5 more) ##          <chr> <chr> <chr>              ##  West Virginia    00 G4000              ##        Florida    00 G4000              ##       Illinois    00 G4000 template <- terra::rast(   s_us_cont,   res = 0.01 ) # us_raster <- rasterize(s_us_cont, template, background=0) # us_raster <- rasterize(as.lines(s_us_cont), template, field='STATEFP',  # touches=TRUE)  us_raster <- terra::rasterize(s_us_cont, template, field = \"STATEFP\")"},{"path":"/articles/spatMicrobiome.html","id":"mapping-soil-locations-to-map","dir":"Articles","previous_headings":"Geographic map formatting requirements","what":"Mapping soil locations to map","title":"spammR microbiome evaluation","text":"Next generate sf object soils coordinate data can map rasterized image US map object: Using rasterization template used , can make soils coordinates fit pixes US map.","code":"oneKSoilsMeta <- oneKSoilsMeta[!is.na(oneKSoilsMeta$latitude) &                                   !is.na(oneKSoilsMeta$longitude), ] coords <- sf::st_as_sf(oneKSoilsMeta, coords = c(\"longitude\", \"latitude\"),                         remove = TRUE) sf::st_crs(coords) <- sf::st_crs(s_us_cont) coords ## Simple feature collection with 127 features and 19 fields ## Geometry type: POINT ## Dimension:     XY ## Bounding box:  xmin: -121.9607 ymin: 28.12584 xmax: -70.63536 ymax: 47.16306 ## Geodetic CRS:  NAD83 ## First 10 features: ##    Sample_ID Site_Code Core_Layer Elev.m Soil.Temperature.C ## 1   ANZA_TOP      ANZA        TOP    191               42.7 ## 2   ANZA_BTM      ANZA        BTM    191               42.7 ## 3   BLAN_TOP      BLAN        TOP    174               19.7 ## 4   BLAN_BTM      BLAN        BTM    174               19.7 ## 5   CFS1_TOP      CFS1        TOP     24               18.5 ## 6   CFS1_BTM      CFS1        BTM     24               18.5 ## 7   CFS2_TOP      CFS2        TOP     24               23.0 ## 8   CFS2_BTM      CFS2        BTM     24               23.0 ## 9   CLBJ_BTM      CLBJ        BTM    274               18.4 ## 10  CLBJ_TOP      CLBJ        TOP    274               18.4 ##    VolWaterContent.m3.m3   pH K_mg_per_kg SO4.S_mg_per_kg B_mg_per_kg ## 1                 0.0490 8.75         107               4        0.25 ## 2                 0.0490 9.20          82               4        0.20 ## 3                 0.1740 6.50         189              10        0.42 ## 4                 0.1740 5.92         122              19        0.27 ## 5                 0.0515 6.66         231              NA          NA ## 6                 0.0515 6.98         107               6        0.26 ## 7                 0.0695 6.66         134               4        0.11 ## 8                 0.0695 6.78          66               2        0.06 ## 9                 0.3380 4.94         144               5        0.18 ## 10                0.3380 7.28         156               6        0.40 ##    Zn_mg_per_kg Mn_mg_per_kg Cu_mg_per_kg Fe_mg_per_kg Ca_Meq_per_100_g ## 1           0.2          1.9          0.1           13             3.27 ## 2           0.3          1.1          0.1           14             3.05 ## 3           0.7         28.3          0.7           54             5.47 ## 4           0.2         15.9          0.5           16             4.31 ## 5            NA           NA           NA           NA             2.41 ## 6           0.3          0.7          0.5           18             2.93 ## 7           3.6          5.1          2.2           48             1.76 ## 8           0.3          2.0          0.3           17             1.13 ## 9           0.4          9.6          0.2           21             1.42 ## 10          1.6          5.9          0.2           12             9.02 ##    Mg_Meq_per_100_g Na_Meq_per_100_g BIOME ## 1              0.26             0.10    13 ## 2              0.42             0.08    13 ## 3              0.81             0.05     4 ## 4              0.57             0.06     4 ## 5              0.68             0.08     5 ## 6              1.14             0.06     5 ## 7              0.50             0.05     4 ## 8              0.32             0.04     4 ## 9              1.08             0.10     8 ## 10             1.04             0.07     8 ##                                     biome_name                   geometry ## 1                   Deserts & Xeric Shrublands  POINT (-116.254 33.30533) ## 2                   Deserts & Xeric Shrublands  POINT (-116.254 33.30533) ## 3          Temperate Broadleaf & Mixed Forests POINT (-78.07207 39.05941) ## 4          Temperate Broadleaf & Mixed Forests POINT (-78.07207 39.05941) ## 5                    Temperate Conifer Forests  POINT (-78.03818 35.3828) ## 6                    Temperate Conifer Forests  POINT (-78.03818 35.3828) ## 7          Temperate Broadleaf & Mixed Forests POINT (-81.43417 35.38329) ## 8          Temperate Broadleaf & Mixed Forests POINT (-81.43417 35.38329) ## 9  Temperate Grasslands, Savannas & Shrublands POINT (-97.57043 33.40164) ## 10 Temperate Grasslands, Savannas & Shrublands POINT (-97.57043 33.40164) coords_rast <- terra::rasterize(coords, template) coords_rast ## class       : SpatRaster  ## size        : 2499, 5796, 1  (nrow, ncol, nlyr) ## resolution  : 0.01, 0.01  (x, y) ## extent      : -124.849, -66.88897, 24.39631, 49.38631  (xmin, xmax, ymin, ymax) ## coord. ref. : lon/lat NAD83 (EPSG:4269)  ## source(s)   : memory ## name        : last  ## min value   :    1  ## max value   :    1"},{"path":"/articles/spatMicrobiome.html","id":"get-the-pixel-xy-not-latlong-xy-of-metagenome-samples","dir":"Articles","previous_headings":"Geographic map formatting requirements > Mapping soil locations to map","what":"get the “Pixel” x/y (NOT lat/long x/y) of metagenome samples","title":"spammR microbiome evaluation","text":"Finally retrieve “pixel” coordinates instead x/y (lat/long) coordinates recorded terra::SpatRaster objects following procedure employed: use extract() get cells coordinates projected raster image use lapply() get raster coordinates (‘pixel’ x/y) row terra::rowColFromCell() use cbind() combine cells, ‘pixel’ x/y original sample coordinate data.frame use dplyr::rename() clean data.frame process come slight differences lat/long. likely due rasterization process? need finally written / transferred spammR package use.","code":"cells <- terra::extract(coords_rast, coords, xy = TRUE, cells = TRUE) print(head(cells)) ##   ID last    cell          x        y ## 1  1    1 9320828 -116.25397 33.30131 ## 2  2    1 9320828 -116.25397 33.30131 ## 3  3    1 5986150  -78.07397 39.06131 ## 4  4    1 5986150  -78.07397 39.06131 ## 5  5    1 8119082  -78.03397 35.38131 ## 6  6    1 8119082  -78.03397 35.38131 cells_tmp <- terra::extract(coords_rast, coords, xy = TRUE, cells = TRUE) xy_rast <- lapply(cells[\"cell\"], function(x) rowColFromCell(coords_rast, x)) cells <- cells_tmp %>%   cbind(., oneKSoilsMeta, xy_rast) %>%   dplyr::rename(., y_pixels = \"cell.1\", x_pixels = \"cell.2\") %>%   subset(., select = -c(x, y, ID, last)) cells$y_pixels <- nrow(coords_rast) - cells$y_pixels"},{"path":"/articles/spatMicrobiome.html","id":"exporting-the-rasterized-map","dir":"Articles","previous_headings":"Geographic map formatting requirements > Mapping soil locations to map","what":"Exporting the rasterized map","title":"spammR microbiome evaluation","text":"rasterized map can exported command .","code":"terra::writeRaster(us_raster, \"us_map.png\", NAflag = 0, overwrite = TRUE)"},{"path":"/articles/spatMicrobiome.html","id":"examplary-plotting","dir":"Articles","previous_headings":"Geographic map formatting requirements > Mapping soil locations to map","what":"Examplary plotting","title":"spammR microbiome evaluation","text":"","code":"coords_test <- sf::st_as_sf(oneKSoilsMeta,                              coords = c(\"longitude\", \"latitude\"),                              remove = TRUE) sf::st_crs(coords_test) <- sf::st_crs(s_us_cont) plot(us_raster, col = \"grey\") # lines(as.polygons(us_raster), col='black') plot(coords_test, col = \"darkred\", add = TRUE) ## Warning in plot.sf(coords_test, col = \"darkred\", add = TRUE): ignoring all but ## the first attribute"},{"path":"/articles/spatMicrobiome.html","id":"using-spammr-on-metagenomic-geographic-data","dir":"Articles","previous_headings":"","what":"Using spammR on metagenomic geographic data","title":"spammR microbiome evaluation","text":"Now data properly formatted can put SpatialExperiment object needed spammR. data comprised : Omics Measurements: species abundances across regions Omics Metadata: metadata species Sample Metadata: information sample location Image files (generated code): file representing image sample","code":""},{"path":"/articles/spatMicrobiome.html","id":"sample-metadata","dir":"Articles","previous_headings":"Using spammR on metagenomic geographic data","what":"Sample Metadata","title":"spammR microbiome evaluation","text":"build sample metadata table given previously generated coordinate raster rasterization map. SpatialExperiment object requires information x y coordinates information spot image omics data.","code":"dm <- cells rownames(dm) <- dm$Sample_ID # dm[,1] <- NULL dm[, \"cell\"] <- NULL dm[, \"longitude.1\"] <- NULL dm[, \"latitude.1\"] <- NULL dm[, \"Image\"] <- 0 dm[, \"x_max\"] <- ncol(coords_rast) dm[, \"y_max\"] <- nrow(coords_rast) dm[, \"x_origin\"] <- 0 dm[, \"y_origin\"] <- 0 dm[, \"spot_height\"] <- 500 dm[, \"spot_width\"] <- 500 dm[, \"above_40_deg_lat\"] <- dplyr::if_else(dm[, \"latitude\"] >= 40,                                                    true = 1, false = 0) dm[, \"psychrophile\"] <- dplyr::if_else(dm[, \"Soil.Temperature.C\"] <= 15,                                         true = 1, false = 0) dm[, \"Core_Layer_bin\"] <- dplyr::if_else(dm[, \"Core_Layer\"] == \"TOP\",                                           true = \"TOP\", false = \"BTM\") dm[, \"Desert\"] <- dplyr::if_else(dm[, \"BIOME\"] == \"13\",                                   true = \"Desert\", false = \"NonDesert\")  data_meta <- dm head(data_meta) ##          Sample_ID Site_Code Core_Layer latitude  longitude Elev.m ## ANZA_TOP  ANZA_TOP      ANZA        TOP 33.30533 -116.25401    191 ## ANZA_BTM  ANZA_BTM      ANZA        BTM 33.30533 -116.25401    191 ## BLAN_TOP  BLAN_TOP      BLAN        TOP 39.05941  -78.07207    174 ## BLAN_BTM  BLAN_BTM      BLAN        BTM 39.05941  -78.07207    174 ## CFS1_TOP  CFS1_TOP      CFS1        TOP 35.38280  -78.03818     24 ## CFS1_BTM  CFS1_BTM      CFS1        BTM 35.38280  -78.03818     24 ##          Soil.Temperature.C VolWaterContent.m3.m3   pH K_mg_per_kg ## ANZA_TOP               42.7                0.0490 8.75         107 ## ANZA_BTM               42.7                0.0490 9.20          82 ## BLAN_TOP               19.7                0.1740 6.50         189 ## BLAN_BTM               19.7                0.1740 5.92         122 ## CFS1_TOP               18.5                0.0515 6.66         231 ## CFS1_BTM               18.5                0.0515 6.98         107 ##          SO4.S_mg_per_kg B_mg_per_kg Zn_mg_per_kg Mn_mg_per_kg Cu_mg_per_kg ## ANZA_TOP               4        0.25          0.2          1.9          0.1 ## ANZA_BTM               4        0.20          0.3          1.1          0.1 ## BLAN_TOP              10        0.42          0.7         28.3          0.7 ## BLAN_BTM              19        0.27          0.2         15.9          0.5 ## CFS1_TOP              NA          NA           NA           NA           NA ## CFS1_BTM               6        0.26          0.3          0.7          0.5 ##          Fe_mg_per_kg Ca_Meq_per_100_g Mg_Meq_per_100_g Na_Meq_per_100_g BIOME ## ANZA_TOP           13             3.27             0.26             0.10    13 ## ANZA_BTM           14             3.05             0.42             0.08    13 ## BLAN_TOP           54             5.47             0.81             0.05     4 ## BLAN_BTM           16             4.31             0.57             0.06     4 ## CFS1_TOP           NA             2.41             0.68             0.08     5 ## CFS1_BTM           18             2.93             1.14             0.06     5 ##                                   biome_name y_pixels x_pixels Image x_max ## ANZA_TOP          Deserts & Xeric Shrublands      890      860     0  5796 ## ANZA_BTM          Deserts & Xeric Shrublands      890      860     0  5796 ## BLAN_TOP Temperate Broadleaf & Mixed Forests     1466     4678     0  5796 ## BLAN_BTM Temperate Broadleaf & Mixed Forests     1466     4678     0  5796 ## CFS1_TOP           Temperate Conifer Forests     1098     4682     0  5796 ## CFS1_BTM           Temperate Conifer Forests     1098     4682     0  5796 ##          y_max x_origin y_origin spot_height spot_width above_40_deg_lat ## ANZA_TOP  2499        0        0         500        500                0 ## ANZA_BTM  2499        0        0         500        500                0 ## BLAN_TOP  2499        0        0         500        500                0 ## BLAN_BTM  2499        0        0         500        500                0 ## CFS1_TOP  2499        0        0         500        500                0 ## CFS1_BTM  2499        0        0         500        500                0 ##          psychrophile Core_Layer_bin    Desert ## ANZA_TOP            0            TOP    Desert ## ANZA_BTM            0            BTM    Desert ## BLAN_TOP            0            TOP NonDesert ## BLAN_BTM            0            BTM NonDesert ## CFS1_TOP            0            TOP NonDesert ## CFS1_BTM            0            BTM NonDesert"},{"path":"/articles/spatMicrobiome.html","id":"cleaning-up-of-data","dir":"Articles","previous_headings":"Using spammR on metagenomic geographic data","what":"CLEANING UP OF DATA","title":"spammR microbiome evaluation","text":"Limiting selfs top layer soil column.","code":"data_meta <- subset(data_meta, Sample_ID %in% colnames(oneKSoilsData)) oneKSoilsData <- subset(oneKSoilsData, select = data_meta$Sample_ID) data_meta <- data_meta[data_meta$Core_Layer == \"TOP\", ] oneKSoilsData <- oneKSoilsData[, grep(\"TOP\", x = names(oneKSoilsData))]"},{"path":"/articles/spatMicrobiome.html","id":"create-spatialexperiment-object","dir":"Articles","previous_headings":"Using spammR on metagenomic geographic data","what":"Create SpatialExperiment object","title":"spammR microbiome evaluation","text":"Now metadata formatted correctly can create spatialExperiment object.","code":"microbiome.spe <- spammR::convert_to_spe(   oneKSoilsData, ## pooled data table   data_meta, ## pooled metadata   oneKSoilsOmicsMeta, ## protein identifiers   feature_meta_colname = \"KO\", # column name   spatial_coords_colnames = c(\"x_pixels\", \"y_pixels\"),   image_files = c(\"us_map.png\"),   image_sample_ids = \"1000 Soils\",   sample_id = \"1000 Soils\",   image_ids = c(\"0\"),   assay_name = \"KO\" )"},{"path":"/articles/spatMicrobiome.html","id":"metagenomic-differential-expression-and-enrichment","dir":"Articles","previous_headings":"Using spammR on metagenomic geographic data","what":"Metagenomic differential expression and enrichment","title":"spammR microbiome evaluation","text":"pathway enrichment analysis done based presence absence KO associations found within individual metagenomes. strictly working “gene abundances” expected traditional differential expression pathway enrichment analysis. Conversely “abundance” measurements individual KOs also distribute differently expected. end relying count based differential expression analysis based limma::voom.","code":"diff_ex <- spammR::calc_spatial_diff_ex(   microbiome.spe,   assay_name = \"KO\",   count_based = TRUE,   log_transformed = FALSE,   category_col = \"Desert\" ) ## We found 562 features with a logFC greater than 1 and  ##                  an ajusted p-value less than 0.05 sig_ko <- subset(rowData(diff_ex), Desert_vs_NonDesert.adj.P.Val.limma < 0.05) ups <- subset(sig_ko, Desert_vs_NonDesert.logFC.limma > 0) downs <- subset(sig_ko, Desert_vs_NonDesert.logFC.limma < 0)  print(paste(   \"We found\", nrow(sig_ko), \"significantly differentally abundant KOs\",   nrow(ups), \"upregulated KOs and\", nrow(downs), \"downregulated\" )) ## [1] \"We found 575 significantly differentally abundant KOs 483 upregulated KOs and 92 downregulated\" ups %>% as_tibble(.) %>%   arrange(., -Desert_vs_NonDesert.logFC.limma) ## # A tibble: 483 × 8 ##    KO     annotation Desert_vs_NonDesert.logFC.limma Desert_vs_NonDesert.AveEx…¹ ##    <chr>  <chr>                                <dbl>                       <dbl> ##  1 K21136 11079                                 4.30                        5.91 ##  2 K15547 8600                                  4.15                        4.98 ##  3 K09758 5602                                  4.07                        5.42 ##  4 K01535 1144                                  4.04                        5.02 ##  5 K15549 8602                                  4.04                        5.18 ##  6 K07085 4377                                  3.87                        7.23 ##  7 K12137 6892                                  3.87                        6.94 ##  8 K13926 7769                                  3.71                        5.59 ##  9 K05817 3685                                  3.64                        5.74 ## 10 K21134 11077                                 3.56                        7.72 ## # ℹ 473 more rows ## # ℹ abbreviated name: ¹​Desert_vs_NonDesert.AveExpr.limma ## # ℹ 4 more variables: Desert_vs_NonDesert.t.limma <dbl>, ## #   Desert_vs_NonDesert.P.Value.limma <dbl>, ## #   Desert_vs_NonDesert.adj.P.Val.limma <dbl>, ## #   Desert_vs_NonDesert.B.limma <dbl>"},{"path":"/articles/spatMicrobiome.html","id":"spatial-heatmap-showing-abundance-of-significant-ko","dir":"Articles","previous_headings":"Using spammR on metagenomic geographic data","what":"Spatial heatmap showing abundance of significant KO","title":"spammR microbiome evaluation","text":"K09758 (aspartate 4-decarboxylase) one “upregulated KOs” can visualize abundances across different sampling locations spammr::spatial_heatmap()","code":"spatial_heatmap(   microbiome.spe,   feature = \"K09758\",   # feature_type = 'KO',   assay_name = \"KO\",   sample_id = \"1000 Soils\",   image_id = \"0\",   sample_label_size = 2.0,    title_size = 10,    label_column = \"Desert\",   metric_display = \"KO association abundance\",   plot_title = \"Abundance of aspartate 4-decarboxylase (K09758)\",   interactive = FALSE ) ## Warning: Removed 2 rows containing missing values or values outside the scale range ## (`geom_label()`)."},{"path":"/articles/spatMicrobiome.html","id":"pathway-enrichment","dir":"Articles","previous_headings":"Using spammR on metagenomic geographic data","what":"Pathway enrichment","title":"spammR microbiome evaluation","text":"pathway enrichment part anaysis first need load “genesets” required format leapR called internally. geneset effectively list KOs associated individual KEGG pathways. Next performing enrichment analysis p-value cut-p-value < 0.05","code":"kk <- download.file(\"https://api.figshare.com/v2/file/download/55158818\",                      destfile = \"kegg.rda\", quiet = TRUE) load(\"kegg.rda\") file.remove(\"kegg.rda\") ## [1] TRUE ora.res <- spammR::enrich_ora(diff_ex, geneset = keggPathwayToKo,                                geneset_name = \"KEGG pathways\",                                feature_column = \"KO\", pval_thresh = 0.05)    filtered_res <- ora.res %>%    rownames_to_column(., var = 'KEGG_Pathway') %>%   as_tibble(.) %>%   filter(., oddsratio > 1 & BH_pvalue < 0.05) %>%   arrange(-oddsratio) %>%   select(KEGG_Pathway, oddsratio, BH_pvalue)  pathway_names <- cbind(keggPathwayToKo$name, keggPathwayToKo$desc) %>%    as_tibble() %>%    rename(., KEGG_Pathway = V1, KEGG_pathway_name = V2) ## Warning: The `x` argument of `as_tibble.matrix()` must have unique column names if ## `.name_repair` is omitted as of tibble 2.0.0. ## ℹ Using compatibility `.name_repair`. ## This warning is displayed once per session. ## Call `lifecycle::last_lifecycle_warnings()` to see where this warning was ## generated. left_join(filtered_res, pathway_names, by = 'KEGG_Pathway') ## # A tibble: 8 × 4 ##   KEGG_Pathway oddsratio   BH_pvalue KEGG_pathway_name               ##   <chr>            <dbl>       <dbl> <chr>                           ## 1 map01320          8.25 0.000266    Sulfur cycle                    ## 2 map00540          7.64 0.000380    Lipopolysaccharide biosynthesis ## 3 map00480          5.00 0.0302      Glutathione metabolism          ## 4 map00362          4.91 0.0000118   Benzoate degradation            ## 5 map00920          4.44 0.000266    Sulfur metabolism               ## 6 map00627          3.98 0.0183      Aminobenzoate degradation       ## 7 map02020          2.70 0.000000387 Two-component system            ## 8 map02010          2.25 0.000266    ABC transporters ora.res <- tibble::rownames_to_column(ora.res, \"pathways\") pathway_prots <- subset(ora.res, pathways == \"map01320\") |>   dplyr::select(ingroupnames) pathway_prots <- unlist(strsplit(pathway_prots[1, ], split = \", \")) spatial_heatmap(     microbiome.spe,     feature = pathway_prots,     assay_name = \"KO\",     sample_id = \"1000 Soils\",     image_id = \"0\",     label_column = \"Desert\",     sample_label_size = 2.0,     title_size = 10,      metric_display = \"Enriched KO Groups\",     plot_title = \"Sulfur cycle\",     interactive = FALSE ) ## Warning: Removed 2 rows containing missing values or values outside the scale range ## (`geom_label()`)."},{"path":"/articles/spatMicrobiome.html","id":"session-information","dir":"Articles","previous_headings":"Using spammR on metagenomic geographic data","what":"Session Information","title":"spammR microbiome evaluation","text":"","code":"sessionInfo() ## R version 4.5.2 (2025-10-31) ## Platform: aarch64-apple-darwin20 ## Running under: macOS Tahoe 26.2 ##  ## Matrix products: default ## BLAS:   /System/Library/Frameworks/Accelerate.framework/Versions/A/Frameworks/vecLib.framework/Versions/A/libBLAS.dylib  ## LAPACK: /Library/Frameworks/R.framework/Versions/4.5-arm64/Resources/lib/libRlapack.dylib;  LAPACK version 3.12.1 ##  ## locale: ## [1] en_US.UTF-8/en_US.UTF-8/en_US.UTF-8/C/en_US.UTF-8/en_US.UTF-8 ##  ## time zone: America/Los_Angeles ## tzcode source: internal ##  ## attached base packages: ## [1] stats4    stats     graphics  grDevices utils     datasets  methods   ## [8] base      ##  ## other attached packages: ##  [1] terra_1.8-93                sf_1.0-24                   ##  [3] dplyr_1.1.4                 magrittr_2.0.4              ##  [5] tibble_3.3.1                ggplot2_4.0.1               ##  [7] spammR_0.99.17              limma_3.66.0                ##  [9] SpatialExperiment_1.20.0    SingleCellExperiment_1.32.0 ## [11] SummarizedExperiment_1.40.0 Biobase_2.70.0              ## [13] GenomicRanges_1.62.1        Seqinfo_1.0.0               ## [15] IRanges_2.44.0              S4Vectors_0.48.0            ## [17] BiocGenerics_0.56.0         generics_0.1.4              ## [19] MatrixGenerics_1.22.0       matrixStats_1.5.0           ## [21] BiocStyle_2.38.0            ##  ## loaded via a namespace (and not attached): ##   [1] DBI_1.2.3           deldir_2.0-4        gridExtra_2.3       ##   [4] s2_1.1.9            rlang_1.1.7         otel_0.2.0          ##   [7] e1071_1.7-17        compiler_4.5.2      png_0.1-8           ##  [10] systemfonts_1.3.1   vctrs_0.7.1         wk_0.9.5            ##  [13] pkgconfig_2.0.3     fastmap_1.2.0       backports_1.5.0     ##  [16] magick_2.9.0        XVector_0.50.0      labeling_0.4.3      ##  [19] ggraph_2.2.2        utf8_1.2.6          rmarkdown_2.30      ##  [22] tzdb_0.5.0          ragg_1.5.0          purrr_1.2.1         ##  [25] xfun_0.56           cachem_1.1.0        jsonlite_2.0.0      ##  [28] DelayedArray_0.36.0 tweenr_2.0.3        broom_1.0.12        ##  [31] R6_2.6.1            bslib_0.10.0        RColorBrewer_1.1-3  ##  [34] reticulate_1.44.1   boot_1.3-32         car_3.1-3           ##  [37] jquerylib_0.1.4     leapR_0.99.6        Rcpp_1.1.1          ##  [40] bookdown_0.46       knitr_1.51          readr_2.1.6         ##  [43] Matrix_1.7-4        igraph_2.2.1        tidyselect_1.2.1    ##  [46] rstudioapi_0.18.0   abind_1.4-8         yaml_2.3.12         ##  [49] viridis_0.6.5       codetools_0.2-20    lattice_0.22-7      ##  [52] withr_3.0.2         S7_0.2.1            evaluate_1.0.5      ##  [55] desc_1.4.3          units_1.0-0         proxy_0.4-29        ##  [58] spData_2.3.4        polyclip_1.10-7     pillar_1.11.1       ##  [61] BiocManager_1.30.27 ggpubr_0.6.2        carData_3.0-5       ##  [64] KernSmooth_2.23-26  plotly_4.12.0       sp_2.2-0            ##  [67] hms_1.1.4           scales_1.4.0        class_7.3-23        ##  [70] glue_1.8.0          lazyeval_0.2.2      tools_4.5.2         ##  [73] data.table_1.18.2.1 ggnewscale_0.5.2    ggsignif_0.6.4      ##  [76] fs_1.6.6            graphlayouts_1.2.2  tidygraph_1.3.1     ##  [79] grid_4.5.2          spdep_1.4-1         impute_1.84.0       ##  [82] tidyr_1.3.2         ggforce_0.5.0       Formula_1.2-5       ##  [85] cli_3.6.5           textshaping_1.0.4   S4Arrays_1.10.1     ##  [88] viridisLite_0.4.2   gtable_0.3.6        rstatix_0.7.3       ##  [91] sass_0.4.10         digest_0.6.39       classInt_0.4-11     ##  [94] SparseArray_1.10.8  ggrepel_0.9.6       rjson_0.2.23        ##  [97] htmlwidgets_1.6.4   farver_2.1.2        memoise_2.0.1       ## [100] htmltools_0.5.9     pkgdown_2.2.0       lifecycle_1.0.5     ## [103] httr_1.4.7          statmod_1.5.1       MASS_7.3-65"},{"path":"/articles/spatProt.html","id":"getting-started","dir":"Articles","previous_headings":"","what":"Getting started","title":"spammR Spatial Proteomics Example","text":"install package currently must install directly GitHub along leapR dependency shown . release hope move Bioconductor. leapR package designed flexible pathway enrichment currently must installed spammR. package installed load library, including test data.","code":"##install if not already installed   library(devtools)   devtools::install_github('PNNL-CompBio/leapR')   devtools::install_github('PNNL-CompBio/spammR') ## load spammR library(spammR)"},{"path":"/articles/spatProt.html","id":"collecting-data-to-analyze","dir":"Articles","previous_headings":"","what":"Collecting data to analyze","title":"spammR Spatial Proteomics Example","text":"spammR enables analysis disparate sets multiomic data: image-based data numerical measurements omics data. incredibly flexible type multiomic data. assume omics measurement collected single sample, specific spatial coordinates sample image. leverage SpatialExperiment object store data image/measurement pair.","code":""},{"path":"/articles/spatProt.html","id":"data-overview-and-examples","dir":"Articles","previous_headings":"Collecting data to analyze","what":"Data overview and examples","title":"spammR Spatial Proteomics Example","text":"spammR package requires omics data spatial coordinates functions run successfully. describe data required show examples.","code":""},{"path":"/articles/spatProt.html","id":"omics-measurement-data","dir":"Articles","previous_headings":"Collecting data to analyze > Data overview and examples","what":"Omics Measurement Data","title":"spammR Spatial Proteomics Example","text":"SpatialExperiment can hold multiple omics measurements mapping sample identifier different ‘slots’. data can tabular data frame matrix rownames referencing measurements particular sample (e.g. gene, species) column names representing sample identifiers. example can found loading pancDataList.rda file Figshare. evaluate features package using pancreatic data Gosline et al. captured using mass spectrometry measured 7 independent regions single human pancreas. image segmented nine ‘voxels’, one voxel per image representing cluster islet cells. rownames represent protein identifiers column names represent individual samples. element list contains measurements different sample: list used analysis examples.","code":"download.file(\"https://api.figshare.com/v2/file/download/55158821\",               mode = \"wb\", quiet = TRUE, dest = \"pdl.rda\") load(\"pdl.rda\") utils::head(pancDataList$Image_0[, 1:8]) ##                            0_S_1_1  0_S_1_2  0_S_1_3  0_S_2_1  0_S_2_2  0_S_2_3 ## sp|A0A024RBG1|NUD4B_HUMAN 13.06042 13.42317 12.42396 13.02470 12.56442 12.69023 ## sp|A0A096LP55|QCR6L_HUMAN 15.10920 15.27460 15.16780 15.01030 15.46639 14.73712 ## sp|A0AV96|RBM47_HUMAN     17.40246 17.29727 17.25559 17.34851 17.12866 17.17658 ## sp|A0AVT1|UBA6_HUMAN      18.00653 18.43015 18.24663 18.17563 18.38961 18.29268 ## sp|A0FGR8|ESYT2_HUMAN     16.59018 16.48890 16.50134 16.55334 16.32316 16.43397 ## sp|A0MZ66|SHOT1_HUMAN     18.19277 18.73633 18.54485 18.20005 18.74041 18.70762 ##                            0_S_3_1  0_S_3_2 ## sp|A0A024RBG1|NUD4B_HUMAN       NA 13.40670 ## sp|A0A096LP55|QCR6L_HUMAN 14.81792 15.63741 ## sp|A0AV96|RBM47_HUMAN     17.27792 17.11678 ## sp|A0AVT1|UBA6_HUMAN      18.12080 18.10220 ## sp|A0FGR8|ESYT2_HUMAN     16.43682 16.20515 ## sp|A0MZ66|SHOT1_HUMAN     18.60198 18.62946 file.remove(\"pdl.rda\") ## [1] TRUE print(length(pancDataList)) ## [1] 7 head(pancDataList[[2]][, 1:8]) ##                            1_S_1_1  1_S_1_2  1_S_1_3  1_S_2_1  1_S_2_2  1_S_2_3 ## sp|A0A024RBG1|NUD4B_HUMAN       NA       NA       NA       NA       NA       NA ## sp|A0A096LP55|QCR6L_HUMAN       NA       NA       NA       NA       NA       NA ## sp|A0AV96|RBM47_HUMAN     17.68866 17.58076 17.51335 17.65900 17.52926 17.44999 ## sp|A0AVT1|UBA6_HUMAN      18.02235 18.35493 18.03651 18.09462 18.08796 18.04204 ## sp|A0FGR8|ESYT2_HUMAN     17.50177 17.51525 17.34338 17.41622 17.34254 17.46062 ## sp|A0MZ66|SHOT1_HUMAN     18.57445 18.67262 18.83672 18.69094 18.48785 18.75190 ##                            1_S_3_1  1_S_3_2 ## sp|A0A024RBG1|NUD4B_HUMAN       NA       NA ## sp|A0A096LP55|QCR6L_HUMAN       NA       NA ## sp|A0AV96|RBM47_HUMAN     17.37103 17.50367 ## sp|A0AVT1|UBA6_HUMAN      18.21052 17.94707 ## sp|A0FGR8|ESYT2_HUMAN     17.31495 17.53217 ## sp|A0MZ66|SHOT1_HUMAN     18.82805 18.48856"},{"path":"/articles/spatProt.html","id":"sample-metadata","dir":"Articles","previous_headings":"Collecting data to analyze > Data overview and examples","what":"Sample metadata","title":"spammR Spatial Proteomics Example","text":"samples metadata table contains mappings samples metadata. example can found data(pancMeta). importantly require image mapping information, includes: - Image coordinates: map image coordinate space need know x_origin, y_origin (assumed zero) well x_max y_max, top right image. package plots entire image specifying coordinates ensures points properly mapped. - Sample coordinates: sample x_coord y_coord. - Spot size: spot_height spot_width. metadata contains information 7 images, need separate metadata file image, convert_to_spe function simply take metadata relevant data file.","code":"data(pancMeta) head(pancMeta) ##         Image x_coord y_coord IsletStatus IsletOrNot Plex Grid.Number x_pixels ## 0_S_3_1     0       3       1    Proximal   NonIslet 127N           1      475 ## 0_S_2_1     0       2       1       Islet      Islet 128N           2      380 ## 0_S_1_1     0       1       1    Proximal   NonIslet 127C           3      285 ## 0_S_3_2     0       3       2    Proximal   NonIslet 128C           4      475 ## 0_S_2_2     0       2       2    Proximal   NonIslet 129N           5      380 ## 0_S_1_2     0       1       2    Proximal   NonIslet 129C           6      285 ##         y_pixels x_origin y_origin x_max y_max spot_width spot_height ## 0_S_3_1      170        0        0   860   725         90         140 ## 0_S_2_1      170        0        0   860   725         90         140 ## 0_S_1_1      170        0        0   860   725         90         140 ## 0_S_3_2      315        0        0   860   725         90         140 ## 0_S_2_2      315        0        0   860   725         90         140 ## 0_S_1_2      315        0        0   860   725         90         140"},{"path":"/articles/spatProt.html","id":"image-files","dir":"Articles","previous_headings":"Collecting data to analyze > Data overview and examples","what":"Image files","title":"spammR Spatial Proteomics Example","text":"can multiple image files associated single set omics measurements. Currently tested working files png format. image stained can identify Islet cells. image also grid superimposed show sample measurements came . grid necessary, course, can help alibrate coordinates. Now can use image others visualize omics data.","code":"library(cowplot)  cowplot::ggdraw() + cowplot::draw_image(system.file(\"extdata\",                                                     \"Image_1.png\",                                                     package = \"spammR\"))"},{"path":"/articles/spatProt.html","id":"omics-metadata","dir":"Articles","previous_headings":"Collecting data to analyze > Data overview and examples","what":"Omics metadata","title":"spammR Spatial Proteomics Example","text":"last set metadata relates rows omics measurement data. using gene-based data, genes proteins dataset. using metagenomics, refer species. One column table must uniquely map rownames omics data. data helps us find better gene identifiers.","code":"data(protMeta) head(protMeta[, c(\"pancProts\", \"EntryName\", \"PrimaryGeneName\")]) ##                   pancProts   EntryName PrimaryGeneName ## 1 sp|A0A024RBG1|NUD4B_HUMAN NUD4B_HUMAN          NUDT4B ## 2 sp|A0A096LP55|QCR6L_HUMAN QCR6L_HUMAN          UQCRHL ## 3     sp|A0AV96|RBM47_HUMAN RBM47_HUMAN           RBM47 ## 4      sp|A0AVT1|UBA6_HUMAN  UBA6_HUMAN            UBA6 ## 5     sp|A0FGR8|ESYT2_HUMAN ESYT2_HUMAN           ESYT2 ## 6     sp|A0MZ66|SHOT1_HUMAN SHOT1_HUMAN           SHTN1"},{"path":"/articles/spatProt.html","id":"loading-data-into-spatial-experiment-object-","dir":"Articles","previous_headings":"Collecting data to analyze","what":"Loading data into spatial experiment object.","title":"spammR Spatial Proteomics Example","text":"Now data loaded can build SpatialExperiment object either using samples just samples single image. can pool data statistical power. can also create list SpatialExperiment objects, one 3 images . Now can use individual image objects combined ‘pooled’ object analysis.","code":"pooledData <- dplyr::bind_cols(pancDataList) pooled.panc.spe <- convert_to_spe(pooledData, ## pooled data table   pancMeta, ## pooled metadata   protMeta, ## protein identifiers   feature_meta_colname = \"pancProts\", # column name ) ## Spatial object created without spatial coordinate  ##          column names provided. Distance based analysis will not be enabled. ## Note: Only mapping metadata for 6662 features out of 6693 data points print(pooled.panc.spe) ## class: SpatialExperiment  ## dim: 6662 63  ## metadata(0): ## assays(1): proteomics ## rownames(6662): sp|A0A024RBG1|NUD4B_HUMAN sp|A0A096LP55|QCR6L_HUMAN ... ##   sp|Q9Y3M8|STA13_HUMAN sp|Q9Y6X3|SCC4_HUMAN ## rowData names(6): pancProts Entry ... GeneNames PrimaryGeneName ## colnames(63): 0_S_1_1 0_S_1_2 ... 3_S_3_2 3_S_3_3 ## colData names(16): Image x_coord ... spot_height sample_id ## reducedDimNames(0): ## mainExpName: NULL ## altExpNames(0): ## spatialCoords names(0) : ## imgData names(0):"},{"path":"/articles/spatProt.html","id":"spatial-data-with-image","dir":"Articles","previous_headings":"Collecting data to analyze","what":"Spatial data with image","title":"spammR Spatial Proteomics Example","text":"loop images imglist plot expression insulin protein image. expect insulin (INS) highest voxels containing islet cells, label using label_column ‘IsletOrNot’ loaded metadata us.  go visualize entire pathways need first identify groups proteins interest using unsupervised approach.","code":"allimgs <- lapply(imglist, function(x) {     spe <- img.spes[[x]]     res <- spatial_heatmap(spe,       feature = \"INS\",       feature_type = \"PrimaryGeneName\",       sample_id = x,       image_id = \"with_grid\",       label_column = \"IsletOrNot\",       interactive = FALSE   )   return(res) })  allimgs[[2]]"},{"path":"/articles/spatProt.html","id":"expression-and-pathway-analysis","dir":"Articles","previous_headings":"","what":"Expression and pathway analysis","title":"spammR Spatial Proteomics Example","text":"Now ability overlay omic measurements image ones, can identify new features plot visualize . First can employ standard differential expression approaches using voxel labels limma pathway.","code":""},{"path":"/articles/spatProt.html","id":"differential-expression","dir":"Articles","previous_headings":"Expression and pathway analysis","what":"Differential expression","title":"spammR Spatial Proteomics Example","text":"First want identify specific proteins -regulated islet cells (regions labeled ‘islet’) compared regions. can plot set proteins. Now can plot differentially expressed proteins across images.","code":"islet_res <- calc_spatial_diff_ex(pooled.panc.spe,     assay_name = \"proteomics\",     log_transformed = FALSE,     category_col = \"IsletOrNot\" )  # we filter the significant proteins first sig_prots <- subset(rowData(islet_res),                      NonIslet_vs_Islet.adj.P.Val.limma < 0.01) # then separate into up-regulated and down-regulated based on fold chnage ups <- subset(sig_prots, NonIslet_vs_Islet.logFC.limma > 0) downs <- subset(sig_prots, NonIslet_vs_Islet.logFC.limma < 0)  print(paste(   \"We found\", nrow(sig_prots), \"significantly differentally \\   expressed proteins including\",   nrow(ups), \"upregulated proteins and\", nrow(downs), \"downregulated\" )) ## [1] \"We found 241 significantly differentally \\n  expressed proteins including 168 upregulated proteins and 73 downregulated\""},{"path":"/articles/spatProt.html","id":"plot-differentially-expressed-proteins","dir":"Articles","previous_headings":"Expression and pathway analysis","what":"Plot differentially expressed proteins","title":"spammR Spatial Proteomics Example","text":"interested combined expression proteins can also visualize .","code":"spe.plot <- img.spes[[2]]  hup <- spatial_heatmap(spe.plot,     feature = rownames(downs),     sample_id = \"Image_1\",     image_id = \"with_grid\",     label_column = \"IsletOrNot\",     interactive = FALSE )  hup"},{"path":"/articles/spatProt.html","id":"pathway-enrichment-measurements","dir":"Articles","previous_headings":"Expression and pathway analysis","what":"Pathway enrichment measurements","title":"spammR Spatial Proteomics Example","text":"Now can calculate enriched pathways islets.","code":"library(leapR) data(\"krbpaths\") ora.res <- enrich_ora(islet_res, geneset = krbpaths,                        geneset_name = \"krbpaths\",                        feature_column = \"PrimaryGeneName\") print(ora.res[grep(\"INSULIN\", rownames(ora.res)),                c(\"ingroup_n\", \"pvalue\", \"BH_pvalue\")]) ##                                                                                                           ingroup_n ## KEGG_INSULIN_SIGNALING_PATHWAY                                                                                    5 ## BIOCARTA_INSULIN_PATHWAY                                                                                          2 ## REACTOME_GLUCOSE_REGULATION_OF_INSULIN_SECRETION                                                                 13 ## REACTOME_INSULIN_SYNTHESIS_AND_SECRETION                                                                         24 ## REACTOME_REGULATION_OF_INSULIN_LIKE_GROWTH_FACTOR_ACTIVITY_BY_INSULIN_LIKE_GROWTH_FACTOR_BINDING_PROTEINS         0 ## REACTOME_REGULATION_OF_INSULIN_SECRETION                                                                         16 ## REACTOME_REGULATION_OF_INSULIN_SECRETION_BY_ACETYLCHOLINE                                                         7 ## REACTOME_REGULATION_OF_INSULIN_SECRETION_BY_GLUCAGON_LIKE_PEPTIDE_1                                              11 ## REACTOME_REGULATION_OF_INSULIN_SECRETION_BY_FREE_FATTY_ACIDS                                                      7 ## REACTOME_INHIBITION_OF_INSULIN_SECRETION_BY_ADRENALINE_NORADRENALINE                                              4 ##                                                                                                                 pvalue ## KEGG_INSULIN_SIGNALING_PATHWAY                                                                            1.000000e+00 ## BIOCARTA_INSULIN_PATHWAY                                                                                  2.247236e-01 ## REACTOME_GLUCOSE_REGULATION_OF_INSULIN_SECRETION                                                          5.549704e-02 ## REACTOME_INSULIN_SYNTHESIS_AND_SECRETION                                                                  2.522014e-07 ## REACTOME_REGULATION_OF_INSULIN_LIKE_GROWTH_FACTOR_ACTIVITY_BY_INSULIN_LIKE_GROWTH_FACTOR_BINDING_PROTEINS 1.000000e+00 ## REACTOME_REGULATION_OF_INSULIN_SECRETION                                                                  3.897737e-02 ## REACTOME_REGULATION_OF_INSULIN_SECRETION_BY_ACETYLCHOLINE                                                 1.077909e-04 ## REACTOME_REGULATION_OF_INSULIN_SECRETION_BY_GLUCAGON_LIKE_PEPTIDE_1                                       9.083131e-06 ## REACTOME_REGULATION_OF_INSULIN_SECRETION_BY_FREE_FATTY_ACIDS                                              2.897170e-05 ## REACTOME_INHIBITION_OF_INSULIN_SECRETION_BY_ADRENALINE_NORADRENALINE                                      1.628147e-02 ##                                                                                                              BH_pvalue ## KEGG_INSULIN_SIGNALING_PATHWAY                                                                            1.0000000000 ## BIOCARTA_INSULIN_PATHWAY                                                                                  0.9987657450 ## REACTOME_GLUCOSE_REGULATION_OF_INSULIN_SECRETION                                                          0.7062802680 ## REACTOME_INSULIN_SYNTHESIS_AND_SECRETION                                                                  0.0002100838 ## REACTOME_REGULATION_OF_INSULIN_LIKE_GROWTH_FACTOR_ACTIVITY_BY_INSULIN_LIKE_GROWTH_FACTOR_BINDING_PROTEINS 1.0000000000 ## REACTOME_REGULATION_OF_INSULIN_SECRETION                                                                  0.5797883996 ## REACTOME_REGULATION_OF_INSULIN_SECRETION_BY_ACETYLCHOLINE                                                 0.0128271210 ## REACTOME_REGULATION_OF_INSULIN_SECRETION_BY_GLUCAGON_LIKE_PEPTIDE_1                                       0.0037831242 ## REACTOME_REGULATION_OF_INSULIN_SECRETION_BY_FREE_FATTY_ACIDS                                              0.0070612576 ## REACTOME_INHIBITION_OF_INSULIN_SECRETION_BY_ADRENALINE_NORADRENALINE                                      0.3686245089"},{"path":"/articles/spatProt.html","id":"pathway-plotting","dir":"Articles","previous_headings":"Expression and pathway analysis","what":"Pathway plotting","title":"spammR Spatial Proteomics Example","text":"know significantly enriched pathways insulin secretion, let’s plot .  average expression 20 proteins selected shown higher islet cells adjacent cells.","code":"secprots <- ora.res[\"REACTOME_GLUCOSE_REGULATION_OF_INSULIN_SECRETION\", ] |>     dplyr::select(ingroupnames) |>     unlist() |>     strsplit(split = \", \") |>     unlist()  spe.plot <- img.spes[[2]]  hup <- spatial_heatmap(spe.plot,     feature = secprots,     sample_id = \"Image_1\",     image_id = \"with_grid\",     feature_type = \"PrimaryGeneName\",     label_column = \"IsletOrNot\",     plot_title = \"Glucose regulation proteins\",     interactive = FALSE )  hup"},{"path":"/articles/spatProt.html","id":"distance-based-measurements","dir":"Articles","previous_headings":"","what":"Distance based measurements","title":"spammR Spatial Proteomics Example","text":"can also identify features correlated distance feature gradient sample. provide input rank-based statistical tools can help identify pathways.","code":""},{"path":"/articles/spatProt.html","id":"distance-based-measurements-1","dir":"Articles","previous_headings":"Distance based measurements","what":"Distance based measurements","title":"spammR Spatial Proteomics Example","text":"First identify specific feature, Islet cell, use identify proteins correlated distance islet image. Proteins negative correlation decreasing expression farther islet cells. looks like SH3GL1 correlated distance Islet images.","code":"## for each image, let's compute the distance of each voxel to  ## the one labeled 'Islet' rank.imgs <- lapply(   img.spes,   function(x) {     distance_based_analysis(x, \"proteomics\",       sampleCategoryCol = \"IsletOrNot\",       sampleCategoryValue = \"Islet\"     )   } )  ## now we have the distances, let's plot some interesting proteins negProts <- do.call(rbind, lapply(names(rank.imgs), function(x) {     subset(as.data.frame(rowData(rank.imgs[[x]])),             IsletDistancespearmanPval < 0.01) |>       subset(IsletDistancespearmanCor < (-.75)) |>       dplyr::select(PrimaryGeneName, IsletDistancespearmanCor) |>       dplyr::mutate(image = x) }))  print(head(negProts)) ##                       PrimaryGeneName IsletDistancespearmanCor   image ## sp|A6NFH5|FBP12_HUMAN          FABP12               -0.9621024 Image_0 ## sp|O14979|HNRDL_HUMAN         HNRNPDL               -0.9114654 Image_0 ## sp|O15145|ARPC3_HUMAN           ARPC3               -0.8861469 Image_0 ## sp|O43292|GPAA1_HUMAN           GPAA1               -0.8355100 Image_0 ## sp|O43829|ZBT14_HUMAN          ZBTB14               -0.8608285 Image_0 ## sp|O60256|KPRB_HUMAN          PRPSAP2               -0.8355100 Image_0 ## do any proteins show up more than once? icounts <- negProts |>     dplyr::group_by(PrimaryGeneName) |>     dplyr::summarize(numImgs = dplyr::n()) |>     dplyr::arrange(desc(numImgs))   print(icounts) ## # A tibble: 267 × 2 ##    PrimaryGeneName numImgs ##    <chr>             <int> ##  1 CHGA                  2 ##  2 DCAKD                 2 ##  3 ECHS1                 2 ##  4 PFKL                  2 ##  5 PKM                   2 ##  6 PSMD4                 2 ##  7 SH3GL1                2 ##  8 VAMP2                 2 ##  9 AAK1                  1 ## 10 ABCB7                 1 ## # ℹ 257 more rows"},{"path":"/articles/spatProt.html","id":"plot-protein-gradient","dir":"Articles","previous_headings":"Distance based measurements","what":"Plot protein gradient","title":"spammR Spatial Proteomics Example","text":"Now can plot expression protein suspected decreasing expression farther islet cells.start SH3GL1 SP3S2.   expression protein lower farther Islet. Can identify trends proteins?","code":"spatial_heatmap(img.spes[[3]],     feature = \"SH3GL1\",     feature_type = \"PrimaryGeneName\",     sample_id = names(img.spes)[3],     image_id = \"with_grid\",     label_column = \"IsletOrNot\", interactive = FALSE ) spatial_heatmap(img.spes[[2]],     feature = \"AP3S2\",     feature_type = \"PrimaryGeneName\",     sample_id = names(img.spes)[2],     image_id = \"with_grid\",     label_column = \"IsletOrNot\", interactive = FALSE )"},{"path":"/articles/spatProt.html","id":"gradient-based-enrichment","dir":"Articles","previous_headings":"Distance based measurements","what":"Gradient-based enrichment","title":"spammR Spatial Proteomics Example","text":"Rank-based pathway enrichment way evaluate trends pathways -represented ranked list genes. leapR pathway functionality can use rankings input. can see numerous pathways coming enriched across images, including ribosomal translation related pathways. Now can select proteins particular pathway visualize well.","code":"library(leapR) data(\"krbpaths\")  spe <- rank.imgs[[2]] enriched.paths <- enrich_gradient(spe,     geneset = krbpaths,     feature_column = \"PrimaryGeneName\", # mapped to enrichment data     ranking_column = \"IsletDistancespearmanCor\" ) enriched.paths[, \"comp\"] <- rep(names(rank.imgs)[[2]], nrow(enriched.paths)) enriched.paths[, \"krbpaths\"] <- rownames(enriched.paths)  enriched.paths |>   subset(pvalue < 0.01) |>   dplyr::group_by(krbpaths) |>   dplyr::summarize(numImgs = dplyr::n()) |>   dplyr::arrange(desc(numImgs)) ## # A tibble: 2 × 2 ##   krbpaths                                 numImgs ##   <chr>                                      <int> ## 1 REACTOME_DIABETES_PATHWAYS                     1 ## 2 REACTOME_INSULIN_SYNTHESIS_AND_SECRETION       1"},{"path":"/articles/spatProt.html","id":"plotting-pathways-from-gradient","dir":"Articles","previous_headings":"Distance based measurements","what":"Plotting pathways from gradient","title":"spammR Spatial Proteomics Example","text":"shows ribosomal protein expression across image.","code":"rprots <- subset(enriched.paths, krbpaths == \"REACTOME_INSULIN_SYNTHESIS_AND_SECRETION\") |>     dplyr::select(comp, ingroupnames)  rprots <- unlist(strsplit(rprots[1, 2], split = \", \"))  spatial_heatmap(img.spes[[2]],     feature = rprots,     feature_type = \"PrimaryGeneName\",     sample_id = names(img.spes)[2],     image_id = \"with_grid\",     label_column = \"IsletOrNot\", interactive = FALSE )"},{"path":"/articles/spatProt.html","id":"network-plotting","dir":"Articles","previous_headings":"Distance based measurements","what":"Network plotting","title":"spammR Spatial Proteomics Example","text":"can also look correlation ribosomal proteins graph. correlation code takes can reduce graph proteins interested , correlated. highly correlated edges 20 randomly sampled ribosomal proteins.","code":"library(tidygraph) ##  ## Attaching package: 'tidygraph' ## The following objects are masked from 'package:IRanges': ##  ##     active, slice ## The following objects are masked from 'package:S4Vectors': ##  ##     active, rename ## The following object is masked from 'package:stats': ##  ##     filter library(ggraph) ## Loading required package: ggplot2 ##correlation analysis can be slow, so let's only evaluate the top 1000 most variable proteins varprots = apply(assay(img.spes[[2]]),1,var,na.rm = TRUE) |>   sort(decreasing = TRUE) |>   names()  date() ## [1] \"Wed Feb  4 15:21:54 2026\" full_graph <- spatial_network(img.spes[[2]][varprots[1:1000],],                               'proteomics','PrimaryGeneName') ## Joining with `by = join_by(rowval)` date() ## [1] \"Wed Feb  4 15:22:03 2026\" ##how subset for only those 81 proteins rgraph <- full_graph |>   tidygraph::activate(nodes) |>   dplyr::filter(name %in% rprots) |>#[sample(20)]) |>   tidygraph::activate(edges) |>   dplyr::filter(corval > 0.75)  ##then we can plot ggraph::ggraph(rgraph) +     geom_edge_link(aes(colour = corval)) +     geom_node_point() +     geom_node_label(aes(label = name)) ## Using \"stress\" as default layout"},{"path":"/articles/spatProt.html","id":"summary","dir":"Articles","previous_headings":"","what":"Summary","title":"spammR Spatial Proteomics Example","text":"vignette shows various functions apply managing spatial proteomics data spammR.","code":""},{"path":"/articles/spatProt.html","id":"references","dir":"Articles","previous_headings":"","what":"References","title":"spammR Spatial Proteomics Example","text":"Gosline et al. Spatial Experiment","code":""},{"path":"/articles/spatProt.html","id":"session-info","dir":"Articles","previous_headings":"","what":"Session info","title":"spammR Spatial Proteomics Example","text":"","code":"## R version 4.5.2 (2025-10-31) ## Platform: aarch64-apple-darwin20 ## Running under: macOS Tahoe 26.2 ##  ## Matrix products: default ## BLAS:   /System/Library/Frameworks/Accelerate.framework/Versions/A/Frameworks/vecLib.framework/Versions/A/libBLAS.dylib  ## LAPACK: /Library/Frameworks/R.framework/Versions/4.5-arm64/Resources/lib/libRlapack.dylib;  LAPACK version 3.12.1 ##  ## locale: ## [1] en_US.UTF-8/en_US.UTF-8/en_US.UTF-8/C/en_US.UTF-8/en_US.UTF-8 ##  ## time zone: America/Los_Angeles ## tzcode source: internal ##  ## attached base packages: ## [1] stats4    stats     graphics  grDevices utils     datasets  methods   ## [8] base      ##  ## other attached packages: ##  [1] ggraph_2.2.2                ggplot2_4.0.1               ##  [3] tidygraph_1.3.1             leapR_0.99.6                ##  [5] spammR_0.99.17              limma_3.66.0                ##  [7] SpatialExperiment_1.20.0    SingleCellExperiment_1.32.0 ##  [9] SummarizedExperiment_1.40.0 Biobase_2.70.0              ## [11] GenomicRanges_1.62.1        Seqinfo_1.0.0               ## [13] IRanges_2.44.0              S4Vectors_0.48.0            ## [15] BiocGenerics_0.56.0         generics_0.1.4              ## [17] MatrixGenerics_1.22.0       matrixStats_1.5.0           ## [19] BiocStyle_2.38.0            ##  ## loaded via a namespace (and not attached): ##   [1] DBI_1.2.3           deldir_2.0-4        gridExtra_2.3       ##   [4] s2_1.1.9            rlang_1.1.7         magrittr_2.0.4      ##   [7] otel_0.2.0          e1071_1.7-17        compiler_4.5.2      ##  [10] png_0.1-8           systemfonts_1.3.1   vctrs_0.7.1         ##  [13] wk_0.9.5            pkgconfig_2.0.3     fastmap_1.2.0       ##  [16] backports_1.5.0     magick_2.9.0        XVector_0.50.0      ##  [19] labeling_0.4.3      utf8_1.2.6          rmarkdown_2.30      ##  [22] tzdb_0.5.0          ragg_1.5.0          purrr_1.2.1         ##  [25] xfun_0.56           cachem_1.1.0        jsonlite_2.0.0      ##  [28] DelayedArray_0.36.0 tweenr_2.0.3        broom_1.0.12        ##  [31] R6_2.6.1            bslib_0.10.0        RColorBrewer_1.1-3  ##  [34] reticulate_1.44.1   boot_1.3-32         car_3.1-3           ##  [37] jquerylib_0.1.4     Rcpp_1.1.1          bookdown_0.46       ##  [40] knitr_1.51          readr_2.1.6         Matrix_1.7-4        ##  [43] igraph_2.2.1        tidyselect_1.2.1    rstudioapi_0.18.0   ##  [46] abind_1.4-8         yaml_2.3.12         viridis_0.6.5       ##  [49] lattice_0.22-7      tibble_3.3.1        withr_3.0.2         ##  [52] S7_0.2.1            evaluate_1.0.5      sf_1.0-24           ##  [55] desc_1.4.3          units_1.0-0         proxy_0.4-29        ##  [58] spData_2.3.4        polyclip_1.10-7     pillar_1.11.1       ##  [61] BiocManager_1.30.27 ggpubr_0.6.2        carData_3.0-5       ##  [64] KernSmooth_2.23-26  plotly_4.12.0       sp_2.2-0            ##  [67] hms_1.1.4           scales_1.4.0        class_7.3-23        ##  [70] glue_1.8.0          lazyeval_0.2.2      tools_4.5.2         ##  [73] data.table_1.18.2.1 ggnewscale_0.5.2    ggsignif_0.6.4      ##  [76] fs_1.6.6            graphlayouts_1.2.2  grid_4.5.2          ##  [79] spdep_1.4-1         impute_1.84.0       tidyr_1.3.2         ##  [82] ggforce_0.5.0       Formula_1.2-5       cli_3.6.5           ##  [85] textshaping_1.0.4   S4Arrays_1.10.1     viridisLite_0.4.2   ##  [88] dplyr_1.1.4         gtable_0.3.6        rstatix_0.7.3       ##  [91] sass_0.4.10         digest_0.6.39       classInt_0.4-11     ##  [94] SparseArray_1.10.8  ggrepel_0.9.6       rjson_0.2.23        ##  [97] htmlwidgets_1.6.4   farver_2.1.2        memoise_2.0.1       ## [100] htmltools_0.5.9     pkgdown_2.2.0       lifecycle_1.0.5     ## [103] httr_1.4.7          statmod_1.5.1       MASS_7.3-65"},{"path":"/authors.html","id":null,"dir":"","previous_headings":"","what":"Authors","title":"Authors and Citation","text":"Sara Gosline. Maintainer, author.","code":""},{"path":"/authors.html","id":"citation","dir":"","previous_headings":"","what":"Citation","title":"Authors and Citation","text":"Gosline S (2026). spammR: SPatial Analysis Multiomics Measurements R. R package version 0.99.17.","code":"@Manual{,   title = {spammR: SPatial Analysis of Multiomics Measurements in R},   author = {Sara Gosline},   year = {2026},   note = {R package version 0.99.17}, }"},{"path":"/index.html","id":"spammr","dir":"","previous_headings":"","what":"SPatial Analysis of Multiomics Measurements in R","title":"SPatial Analysis of Multiomics Measurements in R","text":"goal spammR provide tools generic analysis omics data measured spatial context. details examples please explore recent publication BioRxiv.","code":""},{"path":"/index.html","id":"installation","dir":"","previous_headings":"","what":"Installation","title":"SPatial Analysis of Multiomics Measurements in R","text":"can install development version spammR like :","code":"library(devtools) devtools::install_github('pnnl-compbio/spammR',build_vignettes = TRUE,force=TRUE)"},{"path":"/index.html","id":"example","dir":"","previous_headings":"","what":"Example","title":"SPatial Analysis of Multiomics Measurements in R","text":"basic example demonstrates organize spatial omics data SpatialExperiment object, required format input data SpammR. constructing SpatialExperiment (SPE spe) object, demonstrate use different functions SpammR.","code":""},{"path":"/index.html","id":"organize-data-into-a-spatialexperiment-object","dir":"","previous_headings":"Example","what":"Organize data into a SpatialExperiment object","title":"SPatial Analysis of Multiomics Measurements in R","text":"","code":"library(spammR)  ## load test data data('smallPancData') data('pancMeta') data('protMeta')"},{"path":"/index.html","id":"build-into-spatialexperiment-object","dir":"","previous_headings":"","what":"build into SpatialExperiment object","title":"SPatial Analysis of Multiomics Measurements in R","text":"","code":"img0.spe<-convert_to_spe(smallPancData$Image_0,pancMeta,protMeta,feature_meta_colname='pancProts',image_files=system.file(\"extdata\",'Image_0.png',package='spammR'),image_samples_common_identifier='Image0',spatialCoords_colnames=c('x_pixels','y_pixels'),samples_common_identifier = 'Image0',image_ids='with_grid')"},{"path":"/index.html","id":"produce-a-spatial-heatmap-for-a-chosen-feature-from-the-data","dir":"","previous_headings":"","what":"Produce a spatial heatmap for a chosen feature from the data","title":"SPatial Analysis of Multiomics Measurements in R","text":"function plots feature values single feature heatmap x-y coordinate system First, define parameters needed plotting. Let’s look spatial expression insulin protein. 1a. Basic spatial heatmap parameters specified user; non-interactive 1b. thing 1a now interactive plot; hovering square gives ’s coordinates, label colored value","code":"res = spatial_heatmap(img0.spe, feature='INS', sample_id='Image0', image_id='with_grid', spatial_coord_names=c('x_pixels','y_pixels'), spot_size=unlist(colData(img0.spe)[1,c('spot_width','spot_height')]), image_boundaries=unlist(colData(img0.spe)[1,c('x_origin','y_origin','x_max','y_max')]),label_column='IsletOrNot', interactive=FALSE) res res = spatial_heatmap(img0.spe, feature='INS', sample_id='Image0', image_id='with_grid', spatial_coord_names=c('x_pixels','y_pixels'), spot_size=unlist(colData(img0.spe)[1,c('spot_width','spot_height')]), image_boundaries=unlist(colData(img0.spe)[1,c('x_origin','y_origin','x_max','y_max')]),label_column='IsletOrNot', interactive=TRUE) res"},{"path":"/index.html","id":"id_2-differential-expression-analysis-comparing-two-types-of-samples-in-the-data-given-in-the-spe-object","dir":"","previous_headings":"Produce a spatial heatmap for a chosen feature from the data","what":"2. Differential expression analysis comparing two types of samples in the data given in the SPE object","title":"SPatial Analysis of Multiomics Measurements in R","text":"2a. Run differential expression using spatialDiffEx() function, compare “Proximal” vs. “Distal” samples Pancreas dataset stored spe_singleImg spatialDiffEx() function requries following input parameters: - spe: Spatial Experiment object - logTransformed: Boolean indicating whether data given spe log2 transformed (TRUE) (FALSE) - category_col: Name column specifies category sample. Example: “IsletStatus” Categories category_col compared differential expression analysis - compare_vals: vector containing names categories category_col compared. example: c(‘Proximal’,‘Distal’) output diffex_spe SpatialExperiment object containing results differential expression analysis, addition already present input spe 2b. access differential expression results returned SPE object? 2c. Produce volcano plot visualize results differential experession analysis spammR, provide functions create typical volcano plot .e. plot shoing -log10(pvalue) vs. log2(fold change), along annotations points based criteria significance provided user. two functions spammR can used depending data structure differential expression results stored. functions volcanoPlot_DiffExSpe() volcanoPlot_DiffExResults(). input parameters needed functions except first parameter (object containing differential expression results). First, define needed input parameters functions differential expression results stored data frame, use volcanoPlot_DiffExResults(). differential expression results stored SPE object, use volcanoPlot_DiffExSpe(). volcanoPlot_DiffExSpe() calls volcanoPlot_DiffExResults():","code":"diffex_spe <-spatialDiffEx(spe_singleImg,TRUE,category_col ='IsletStatus',compare_vals=c('Proximal','Distal')) rowData(diffex_spe) logFC_colname = \"IsletStatus.limma.logFC\" pval_colname = \"IsletStatus.limma.P.Value\" pval_corrected = TRUE title = \"Differential abundance results for Distal vs. Proximal samples; Pancreas dataset spe_SingleImage\" thresh = 0.05 sigLabel_colname = \"X\" diffEx_df = rowData(diffex_spe) volcanoPlot_DiffExResults(diffEx_df, logFC_colname, pval_colname, pval_corrected, title, thresh, sigLabel_colname) volcanoPlot_DiffExSpe(diffex_spe, logFC_colname, pval_colname, pval_corrected, title, thresh, sigLabel_colname)"},{"path":"/reference/calc_centers.html","id":null,"dir":"Reference","previous_headings":"","what":"Calculate centers of spots/samples for distance based analysis — calc_centers","title":"Calculate centers of spots/samples for distance based analysis — calc_centers","text":"calc_centers calculates centers spots numerical analysis.Currently used.","code":""},{"path":"/reference/calc_centers.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Calculate centers of spots/samples for distance based analysis — calc_centers","text":"","code":"calc_centers(spe)"},{"path":"/reference/calc_centers.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Calculate centers of spots/samples for distance based analysis — calc_centers","text":"spe SpatialExperiment object containing omics data","code":""},{"path":"/reference/calc_centers.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Calculate centers of spots/samples for distance based analysis — calc_centers","text":"Data frame new coordinates","code":""},{"path":"/reference/calc_centers.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Calculate centers of spots/samples for distance based analysis — calc_centers","text":"","code":"data(pancMeta) data(protMeta) data(smallPancData) img0.spe <- convert_to_spe(smallPancData$Image_0,   pancMeta,   protMeta,   feature_meta_colname = \"pancProts\",   image_files = system.file(\"extdata\", \"Image_0.png\", package = \"spammR\"),   sample_id = \"Image0\",   spatial_coords_colnames = c(\"x_pixels\", \"y_pixels\"),   image_sample_ids = \"Image0\", image_ids = \"Image0\" ) #> Note: Only mapping metadata for 2986 features out of 3000 data points ## can't actually call internal functuon"},{"path":"/reference/calc_diff_pairwiseSamples.html","id":null,"dir":"Reference","previous_headings":"","what":"Helper function for computing pairwise differences between sample values — calc_diff_pairwiseSamples","title":"Helper function for computing pairwise differences between sample values — calc_diff_pairwiseSamples","text":"function called distance_based_analysis()","code":""},{"path":"/reference/calc_diff_pairwiseSamples.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Helper function for computing pairwise differences between sample values — calc_diff_pairwiseSamples","text":"","code":"calc_diff_pairwiseSamples(feature_values)"},{"path":"/reference/calc_diff_pairwiseSamples.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Helper function for computing pairwise differences between sample values — calc_diff_pairwiseSamples","text":"feature_values 1 x n vector containing values feature n","code":""},{"path":"/reference/calc_diff_pairwiseSamples.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Helper function for computing pairwise differences between sample values — calc_diff_pairwiseSamples","text":"Data frame differences samples. names(feature_values) contain names samples","code":""},{"path":"/reference/calc_missingness.html","id":null,"dir":"Reference","previous_headings":"","what":"Calculate degree of missingness for each featurea and sample — calc_missingness","title":"Calculate degree of missingness for each featurea and sample — calc_missingness","text":"calc_missingness() calculates fraction samples missing data feature, fraction feature missing sample.","code":""},{"path":"/reference/calc_missingness.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Calculate degree of missingness for each featurea and sample — calc_missingness","text":"","code":"calc_missingness(spe, group_name = NULL)"},{"path":"/reference/calc_missingness.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Calculate degree of missingness for each featurea and sample — calc_missingness","text":"spe SpatialExperiment object group_name Name group use denominator","code":""},{"path":"/reference/calc_missingness.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Calculate degree of missingness for each featurea and sample — calc_missingness","text":"SpatialExperiment object missingFeature column added colData missingSample added rowData","code":""},{"path":"/reference/calc_missingness.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Calculate degree of missingness for each featurea and sample — calc_missingness","text":"","code":"library(spammR) data(smallPancData) data(pancMeta) data(protMeta) pooledPanc <- dplyr::bind_cols(smallPancData) panc.spe <- convert_to_spe(pooledPanc, pancMeta, protMeta,            feature_meta_colname = \"pancProts\") #> Spatial object created without spatial coordinate  #>          column names provided. Distance based analysis will not be enabled. #> Note: Only mapping metadata for 2986 features out of 3000 data points calc_missingness(panc.spe) #> class: SpatialExperiment  #> dim: 2986 27  #> metadata(0): #> assays(1): proteomics #> rownames(2986): sp|A0A024RBG1|NUD4B_HUMAN sp|A0A096LP55|QCR6L_HUMAN ... #>   sp|Q7Z2T5|TRM1L_HUMAN sp|Q7Z2W4|ZCCHV_HUMAN #> rowData names(7): pancProts Entry ... PrimaryGeneName missingSample #> colnames(27): 0_S_1_1 0_S_1_2 ... 7_S_3_2 7_S_3_3 #> colData names(17): Image x_coord ... sample_id missingFeature #> reducedDimNames(0): #> mainExpName: NULL #> altExpNames(0): #> spatialCoords names(0) : #> imgData names(1): sample_id"},{"path":"/reference/calc_spatial_diff_ex.html","id":null,"dir":"Reference","previous_headings":"","what":"Identify differentially abundant features across image — calc_spatial_diff_ex","title":"Identify differentially abundant features across image — calc_spatial_diff_ex","text":"calc_spatial_diff_ex() Calculates differential expression analysis using annotations SpatialExperiment object","code":""},{"path":"/reference/calc_spatial_diff_ex.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Identify differentially abundant features across image — calc_spatial_diff_ex","text":"","code":"calc_spatial_diff_ex(   spe,   assay_name = \"proteomics\",   count_based = FALSE,   log_transformed = FALSE,   category_col,   compare_vals )"},{"path":"/reference/calc_spatial_diff_ex.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Identify differentially abundant features across image — calc_spatial_diff_ex","text":"spe Spatial Experiment object containing data used differential expression analysis assay_name Name dataset stored spe object, used differential expression analysis. Example: znormalized_log2 count_based Set TRUE data count based, e.g. RNA-Seq log_transformed data given spe log2 transformed TRUE FALSE category_col Name column specifies category sample. Example: \"IsletOrNot\" #Categories category_col compared differential expression analysis compare_vals vector containing names categories category_col compared. required two values category_col","code":""},{"path":"/reference/calc_spatial_diff_ex.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Identify differentially abundant features across image — calc_spatial_diff_ex","text":"Spatial Experiment object containing differential expression results, stored rowData(diffEx.spe) assays(diffEx.spe) contains dataset differential expresssion analysis carried ","code":""},{"path":"/reference/calc_spatial_diff_ex.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Identify differentially abundant features across image — calc_spatial_diff_ex","text":"","code":"data(smallPancData) data(pancMeta) data(protMeta) pooledData <- dplyr::bind_cols(smallPancData) pooled.panc.spe <- convert_to_spe(pooledData,   pancMeta,   protMeta,   feature_meta_colname = \"pancProts\" ) #> Spatial object created without spatial coordinate  #>          column names provided. Distance based analysis will not be enabled. #> Note: Only mapping metadata for 2986 features out of 3000 data points diffex.spe <- calc_spatial_diff_ex(pooled.panc.spe,   category_col = \"IsletOrNot\" ) #> Warning: Partial NA coefficients for 2 probe(s) #> We found 0 features with a logFC greater than 1 and  #>                  an ajusted p-value less than 0.05"},{"path":"/reference/convert_to_spe.html","id":null,"dir":"Reference","previous_headings":"","what":"Create a SpatialExperiment object from data — convert_to_spe","title":"Create a SpatialExperiment object from data — convert_to_spe","text":"convert_to_spe() Puts omics data (omics measurements, metadata image(s) corresponding samples' tissue) SpatialExperiment (SPE) object. spammR functions require input data SPE object.","code":""},{"path":"/reference/convert_to_spe.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Create a SpatialExperiment object from data — convert_to_spe","text":"","code":"convert_to_spe(   dat,   sample_meta,   feature_meta,   assay_name = \"proteomics\",   sample_id = \"sample\",   sample_colname = NULL,   feature_meta_colname = NULL,   spatial_coords_colnames = NULL,   rescale_image = FALSE,   image_files = NULL,   image_ids = NULL,   image_sample_ids = rep(sample_id, length(image_files)) )"},{"path":"/reference/convert_to_spe.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Create a SpatialExperiment object from data — convert_to_spe","text":"dat Matrix data frame omics measurements. Rows features, columns samples sample_meta Data frame metadata either sample_colname rownames samples (empty) feature_meta Data frame metadata either sample_colname rownames samples (empty) assay_name Name given data omics_measurements_file. Example: \"abundance\", \"log2\", \"znormalized_log2\" descriptive name sample_id Name sample, defaults \"sample01\" sample_colname Column name sample_meta table whose entries contain sample identifiers provided column names dat. feature_meta_colname Name column feature_meta, used identifying features. missing defaults rownames, match rownames dat spatial_coords_colnames list containing names columns meta_dat spatial coordinates. Default value NULL case spatial coordinates entered rescale_image boolean set true need rescale image. Recommended coordinates pulled metaspace known fully cover image image_files list containing paths image files stored SpatialExperiment object. images can added later, without using function. image_ids list containing image names/identifiers image paths provided image_files image_sample_ids list sample identifiers images provided image_files, defaults value sample_id","code":""},{"path":"/reference/convert_to_spe.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Create a SpatialExperiment object from data — convert_to_spe","text":"spe.SpatialExperiment (SPE) object contains data image(s). Ready used input spammR functions require SPE object input.","code":""},{"path":"/reference/convert_to_spe.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Create a SpatialExperiment object from data — convert_to_spe","text":"","code":"data(pancMeta) data(protMeta) data(smallPancData) # We can put all samples into the same object (for statistical power) pooledData <- dplyr::bind_cols(smallPancData) pooled.panc.spe <- convert_to_spe(pooledData,   pancMeta,   protMeta,   feature_meta_colname = \"pancProts\" ) #> Spatial object created without spatial coordinate  #>          column names provided. Distance based analysis will not be enabled. #> Note: Only mapping metadata for 2986 features out of 3000 data points  # or we can add the inmage to a single data capture img0.spe <- convert_to_spe(smallPancData$Image_0,   pancMeta,   protMeta,   sample_id = \"Image0\",   feature_meta_colname = \"pancProts\",   image_files = system.file(\"extdata\", \"Image_0.png\", package = \"spammR\"),   spatial_coords_colnames = c(\"x_pixels\", \"y_pixels\"),   image_ids = \"Image0\" ) #> Note: Only mapping metadata for 2986 features out of 3000 data points"},{"path":"/reference/distance_based_analysis.html","id":null,"dir":"Reference","previous_headings":"","what":"Identify multiomic features correlated with an distance to an image feature — distance_based_analysis","title":"Identify multiomic features correlated with an distance to an image feature — distance_based_analysis","text":"distance_based_analysis: Identifies proteins/features show strong correlation distance specified ROI's samples protein/feature abundance differences samples.","code":""},{"path":"/reference/distance_based_analysis.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Identify multiomic features correlated with an distance to an image feature — distance_based_analysis","text":"","code":"distance_based_analysis(   spe,   assay_name,   spotHeightCol = \"spot_height\",   spotWidthCol = \"spot_width\",   sampleCategoryCol,   sampleCategoryValue,   featuresNameCol,   corr_type = \"spearman\",   corr_thresh = 0.5,   min_samples = 5,   allowOverlaps = TRUE )"},{"path":"/reference/distance_based_analysis.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Identify multiomic features correlated with an distance to an image feature — distance_based_analysis","text":"spe SpatialExperiment object containing spatial omics data assay_name Name assay stored spe used distance based analysis. Example: \"znormalized_log2\" spotHeightCol Column containing height spot spotWidthCol Column containing width spot sampleCategoryCol Column name metadata (colData(spe)) used selecting samples certain type, define \"origin\" region distance based analysis sampleCategoryValue Sample category used defining \"origin\" region distance based analysis featuresNameCol Name column containing features (example: proteins) rowData(spe). assumed data provided assay(spe) order order features listed featuresNameCol corr_type Choose \"pearson\" (default), \"spearman.\" Correlation method used calculating correlation distance samples protein abundance differences. types correlation provide measure monotonic association two variables. Pearson better suited linear relationships Spearman better non-linear monotonic relationships. corr_thresh Minimum correlation value used identifying proteins correlation protein abundance differences distance samples. Values greater equal theshold used. min_samples minimum number sample points calculating correlation. proteins less number sample points, correlation value reported NA. allowOverlaps allow overlaps regions","code":""},{"path":"/reference/distance_based_analysis.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Identify multiomic features correlated with an distance to an image feature — distance_based_analysis","text":"SpatialExperiment object distance based data colData","code":""},{"path":"/reference/distance_based_analysis.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Identify multiomic features correlated with an distance to an image feature — distance_based_analysis","text":"","code":"data(pancMeta) data(protMeta) data(smallPancData) img0.spe <- convert_to_spe(smallPancData$Image_0,   pancMeta,   protMeta,   sample_id = \"Image0\",   spatial_coords_colnames = c(\"x_pixels\", \"y_pixels\"),   feature_meta_colname = \"pancProts\",   image_files = system.file(\"extdata\", \"Image_0.png\", package = \"spammR\"),   image_ids = \"Image0\" ) #> Note: Only mapping metadata for 2986 features out of 3000 data points  img0.spe <- distance_based_analysis(img0.spe,   \"proteomics\",   sampleCategoryCol = \"IsletOrNot\",   sampleCategoryValue = \"Islet\" )"},{"path":"/reference/enrich_gradient.html","id":null,"dir":"Reference","previous_headings":"","what":"Calculate functional or pathway enrichment from a gradient — enrich_gradient","title":"Calculate functional or pathway enrichment from a gradient — enrich_gradient","text":"enrich_gradient() calculates -representation statistics (ORA) using ranking genes distance_based_analysis() ORA using external already defined interest list genes gene sets, use leapR functions directly","code":""},{"path":"/reference/enrich_gradient.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Calculate functional or pathway enrichment from a gradient — enrich_gradient","text":"","code":"enrich_gradient(spe, assay_name, geneset, feature_column, ranking_column)"},{"path":"/reference/enrich_gradient.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Calculate functional or pathway enrichment from a gradient — enrich_gradient","text":"spe SpatialExperiment object containing spatial omics data spatial diffex results assay_name name assay geneset GMT format feature_column Column rowData maps gene set ranking_column Column rowData maps ranks","code":""},{"path":"/reference/enrich_gradient.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Calculate functional or pathway enrichment from a gradient — enrich_gradient","text":"dataframe containing results -representation analysis members gene sets interest list genes based filtering criteria .","code":""},{"path":"/reference/enrich_gradient.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Calculate functional or pathway enrichment from a gradient — enrich_gradient","text":"","code":"data(smallPancData) data(pancMeta) data(protMeta) img0.spe <- convert_to_spe(smallPancData$Image_0,   pancMeta,   protMeta,   feature_meta_colname = \"pancProts\",   image_files = system.file(\"extdata\", \"Image_0.png\", package = \"spammR\"),   image_sample_ids = \"Image0\",   spatial_coords_colnames = c(\"x_pixels\", \"y_pixels\"),   sample_id = \"Image0\",   image_ids = \"Image0\" ) #> Note: Only mapping metadata for 2986 features out of 3000 data points img0.spe <- distance_based_analysis(img0.spe,   \"proteomics\",   sampleCategoryCol = \"IsletOrNot\",   sampleCategoryValue = \"Islet\" ) library(leapR) data(\"krbpaths\") rank.res <- enrich_gradient(img0.spe,   geneset = krbpaths,   feature_column = \"PrimaryGeneName\",   ranking_column = \"IsletDistancespearmanCor\" ) #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties #> Warning: p-value will be approximate in the presence of ties head(rank.res) #>                                                                ingroup_n #> REACTOME_CHOLESTEROL_BIOSYNTHESIS                                     11 #> REACTOME_STEROID_METABOLISM                                           18 #> BIOCARTA_ACTINY_PATHWAY                                               12 #> BIOCARTA_SALMONELLA_PATHWAY                                           10 #> REACTOME_ACTIVATION_OF_THE_AP1_FAMILY_OF_TRANSCRIPTION_FACTORS         6 #> REACTOME_FORMATION_OF_PLATELET_PLUG                                   79 #>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            ingroupnames #> REACTOME_CHOLESTEROL_BIOSYNTHESIS                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 TM7SF2, FDFT1, LSS, MVD, HSD17B7, MVK, LBR, EBP, PMVK, NSDHL, CYP51A1 #> REACTOME_STEROID_METABOLISM                                                                                                                                                                                                                                                                                                                                                                                                                                    SLC27A2, ABCC3, CYP7B1, TM7SF2, ALB, SCP2, FDFT1, LSS, FABP6, HSD17B4, MVD, HSD17B7, MVK, LBR, EBP, PMVK, NSDHL, CYP51A1 #> BIOCARTA_ACTINY_PATHWAY                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  WASL, PIR, PSMA7, ARPC1B, ARPC2, ARPC3, ARPC5, NCK1, ARPC4, ACTR3, ACTR2, RAC1 #> BIOCARTA_SALMONELLA_PATHWAY                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         WASL, ARPC1B, ARPC2, ARPC3, ARPC5, ARPC4, CDC42, ACTR3, ACTR2, RAC1 #> REACTOME_ACTIVATION_OF_THE_AP1_FAMILY_OF_TRANSCRIPTION_FACTORS                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  JUN, MAPK3, MAPK1, MAPK8, MAPK9, MAPK14 #> REACTOME_FORMATION_OF_PLATELET_PLUG                            STXBP3, LEFTY2, PDPK1, ACTN4, CALU, GNG7, WDR1, SOD1, F13A1, SERPINA1, A2M, TIMP1, COL1A1, APOA1, FGA, FGB, FGG, FN1, ALB, TF, ALDOA, VWF, GNAI2, APP, SERPING1, ITGB1, FYN, PSAP, PFN1, LYN, THBS1, COL1A2, GNAI3, CD63, CALM1, CLU, HSPA5, ACTN1, SRC, LAMP2, PECAM1, CD36, PRKCA, ITGA2, PTPN1, VCL, FLNA, CD9, CFL1, DGKA, PIK3R1, GNA11, FCER1G, AKT1, AKT2, ACTN2, CSK, SYK, CRK, GNAQ, VAV2, GNG2, RAP1B, GNB1, GNB2, PPIA, GRB2, GNAI1, GNG5, TUBA4A, CAP1, GNA12, PTK2, STX4, DGKZ, GNA13, ITPR2, ITPR1, MAPK14 #>                                                                ingroup_mean #> REACTOME_CHOLESTEROL_BIOSYNTHESIS                                 0.4810512 #> REACTOME_STEROID_METABOLISM                                       0.3811838 #> BIOCARTA_ACTINY_PATHWAY                                          -0.3818871 #> BIOCARTA_SALMONELLA_PATHWAY                                      -0.4278824 #> REACTOME_ACTIVATION_OF_THE_AP1_FAMILY_OF_TRANSCRIPTION_FACTORS   -0.4207286 #> REACTOME_FORMATION_OF_PLATELET_PLUG                               0.1837898 #>                                                                outgroup_n #> REACTOME_CHOLESTEROL_BIOSYNTHESIS                                    2982 #> REACTOME_STEROID_METABOLISM                                          2982 #> BIOCARTA_ACTINY_PATHWAY                                              2982 #> BIOCARTA_SALMONELLA_PATHWAY                                          2982 #> REACTOME_ACTIVATION_OF_THE_AP1_FAMILY_OF_TRANSCRIPTION_FACTORS       2982 #> REACTOME_FORMATION_OF_PLATELET_PLUG                                  2982 #>                                                                outgroup_mean #> REACTOME_CHOLESTEROL_BIOSYNTHESIS                                 0.03500242 #> REACTOME_STEROID_METABOLISM                                       0.03500242 #> BIOCARTA_ACTINY_PATHWAY                                           0.03500242 #> BIOCARTA_SALMONELLA_PATHWAY                                       0.03500242 #> REACTOME_ACTIVATION_OF_THE_AP1_FAMILY_OF_TRANSCRIPTION_FACTORS    0.03500242 #> REACTOME_FORMATION_OF_PLATELET_PLUG                               0.03500242 #>                                                                    zscore #> REACTOME_CHOLESTEROL_BIOSYNTHESIS                               1.1516930 #> REACTOME_STEROID_METABOLISM                                     0.8634470 #> BIOCARTA_ACTINY_PATHWAY                                        -0.9864392 #> BIOCARTA_SALMONELLA_PATHWAY                                    -1.0279462 #> REACTOME_ACTIVATION_OF_THE_AP1_FAMILY_OF_TRANSCRIPTION_FACTORS -3.0356160 #> REACTOME_FORMATION_OF_PLATELET_PLUG                             0.3493178 #>                                                                 oddsratio #> REACTOME_CHOLESTEROL_BIOSYNTHESIS                               0.5946843 #> REACTOME_STEROID_METABOLISM                                     0.4592357 #> BIOCARTA_ACTINY_PATHWAY                                        -0.5164099 #> BIOCARTA_SALMONELLA_PATHWAY                                    -0.5584059 #> REACTOME_ACTIVATION_OF_THE_AP1_FAMILY_OF_TRANSCRIPTION_FACTORS -0.6135856 #> REACTOME_FORMATION_OF_PLATELET_PLUG                             0.1933453 #>                                                                     pvalue #> REACTOME_CHOLESTEROL_BIOSYNTHESIS                              0.002992787 #> REACTOME_STEROID_METABOLISM                                    0.004281058 #> BIOCARTA_ACTINY_PATHWAY                                        0.004512856 #> BIOCARTA_SALMONELLA_PATHWAY                                    0.005475967 #> REACTOME_ACTIVATION_OF_THE_AP1_FAMILY_OF_TRANSCRIPTION_FACTORS 0.007849053 #> REACTOME_FORMATION_OF_PLATELET_PLUG                            0.008232740 #>                                                                BH_pvalue #> REACTOME_CHOLESTEROL_BIOSYNTHESIS                              0.8515129 #> REACTOME_STEROID_METABOLISM                                    0.8515129 #> BIOCARTA_ACTINY_PATHWAY                                        0.8515129 #> BIOCARTA_SALMONELLA_PATHWAY                                    0.8515129 #> REACTOME_ACTIVATION_OF_THE_AP1_FAMILY_OF_TRANSCRIPTION_FACTORS 0.8534607 #> REACTOME_FORMATION_OF_PLATELET_PLUG                            0.8534607 #>                                                                SignedBH_pvalue #> REACTOME_CHOLESTEROL_BIOSYNTHESIS                                    0.8515129 #> REACTOME_STEROID_METABOLISM                                          0.8515129 #> BIOCARTA_ACTINY_PATHWAY                                             -0.8515129 #> BIOCARTA_SALMONELLA_PATHWAY                                         -0.8515129 #> REACTOME_ACTIVATION_OF_THE_AP1_FAMILY_OF_TRANSCRIPTION_FACTORS      -0.8534607 #> REACTOME_FORMATION_OF_PLATELET_PLUG                                  0.8534607 #>                                                                background_n #> REACTOME_CHOLESTEROL_BIOSYNTHESIS                                        NA #> REACTOME_STEROID_METABOLISM                                              NA #> BIOCARTA_ACTINY_PATHWAY                                                  NA #> BIOCARTA_SALMONELLA_PATHWAY                                              NA #> REACTOME_ACTIVATION_OF_THE_AP1_FAMILY_OF_TRANSCRIPTION_FACTORS           NA #> REACTOME_FORMATION_OF_PLATELET_PLUG                                      NA #>                                                                background_mean #> REACTOME_CHOLESTEROL_BIOSYNTHESIS                                           NA #> REACTOME_STEROID_METABOLISM                                                 NA #> BIOCARTA_ACTINY_PATHWAY                                                     NA #> BIOCARTA_SALMONELLA_PATHWAY                                                 NA #> REACTOME_ACTIVATION_OF_THE_AP1_FAMILY_OF_TRANSCRIPTION_FACTORS              NA #> REACTOME_FORMATION_OF_PLATELET_PLUG                                         NA"},{"path":"/reference/enrich_ora.html","id":null,"dir":"Reference","previous_headings":"","what":"Calculate functional or pathway enrichment — enrich_ora","title":"Calculate functional or pathway enrichment — enrich_ora","text":"enrich_ora() calculates -representation statistics (ORA) using interest list genes differential expression results spammR gene sets (either ones provided spammR user supplied) function uses results calc_spatial_diff_ex. Interest list genes ORA obtained spatialDiffEx results based criteria specified function.wrapper leapR package required ORA using external already defined interest list genes gene sets, use leapR functions directly","code":""},{"path":"/reference/enrich_ora.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Calculate functional or pathway enrichment — enrich_ora","text":"","code":"enrich_ora(   spe,   geneset,   feature_column,   pval_type_forThresh = \"adjusted_pval\",   pval_thresh = 0.05,   logFC_lowerThresh = NA,   logFC_upperThresh = NA,   geneset_name = \"msigdb\",   sortResultsBy,   comparison_name = \"\" )"},{"path":"/reference/enrich_ora.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Calculate functional or pathway enrichment — enrich_ora","text":"spe SpatialExperiment object containing spatial omics data spatial diffex results geneset GMT format feature_column Column rowData maps gene set pval_type_forThresh Choose \"adjusted_pval\" \"pval\". Type p-value used filtering statistically significant results. Default adjusted p-value multiple hypotheses correction. pval_thresh value use filtering based pval_type_forThreshold. Default 0.05. Values less pval_thresh kept. logFC_lowerThresh Lower threshold log Fold Change, used filtering spatialDiffEx results. Default NA logFC_upperThresh Upper threshold log Fold Change, used filtering spatialDiffEx results. Default NA geneset_name Name geneset provided sortResultsBy sorting ORA results, choose following column names: \"BH_pvalue\" (default) comparison_name Example: \"RSPv_vs_others\" Text indicate results data frame, spatial groups compared interest list genes","code":""},{"path":"/reference/enrich_ora.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Calculate functional or pathway enrichment — enrich_ora","text":"dataframe containing results -representation analysis members gene sets interest list genes based filtering criteria .","code":""},{"path":"/reference/enrich_ora.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Calculate functional or pathway enrichment — enrich_ora","text":"","code":"data(smallPancData) data(pancMeta) data(protMeta) pooledPanc <- dplyr::bind_cols(smallPancData) panc.spe <- convert_to_spe(pooledPanc, pancMeta, protMeta,  feature_meta_colname = \"pancProts\") #> Spatial object created without spatial coordinate  #>          column names provided. Distance based analysis will not be enabled. #> Note: Only mapping metadata for 2986 features out of 3000 data points diffex.spe <- calc_spatial_diff_ex(panc.spe, category_col = \"IsletOrNot\") #> Warning: Partial NA coefficients for 2 probe(s) #> We found 0 features with a logFC greater than 1 and  #>                  an ajusted p-value less than 0.05 library(leapR) data(\"krbpaths\") ora.res <- enrich_ora(diffex.spe, geneset = krbpaths,           geneset_name = \"krbpaths\", feature_column = \"PrimaryGeneName\")"},{"path":"/reference/impute_spe.html","id":null,"dir":"Reference","previous_headings":"","what":"Impute missing values based on spatial coordinates — impute_spe","title":"Impute missing values based on spatial coordinates — impute_spe","text":"impute_spe() carries imputation missing data primary assay using specified method range methods. Returns additional assay SPE","code":""},{"path":"/reference/impute_spe.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Impute missing values based on spatial coordinates — impute_spe","text":"","code":"impute_spe(   spe,   assay_name = NULL,   method = NULL,   group_colname,   k = NULL,   protein_missingness = NULL )"},{"path":"/reference/impute_spe.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Impute missing values based on spatial coordinates — impute_spe","text":"spe SPE containing data imputed. assay_name name assay data imputed method Method imputation used. See details. group_colname Column name metadata specifies group information use group_mean knn_group. Example: ROI_abbreviation. k K value used k-nearest neighbor imputation protein_missingness Proportion samples allowed missing data protein given imputation method. Example: method=\"global_mean,\" protein_missingness 0.5 indicates protein missing data 50% samples across entire spatial tissue covered samples excluded imputation method algorithm, protein's missing values imputed. method=\"group_mean,\" protein_missingness 0.5 indicates protein must data least 50% samples specified group used imputation algorithm imputed.","code":""},{"path":"/reference/impute_spe.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Impute missing values based on spatial coordinates — impute_spe","text":"SPE 'imputed' assay appropriate imputation called","code":""},{"path":"/reference/impute_spe.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Impute missing values based on spatial coordinates — impute_spe","text":"Methods options descriptions: zero: replace missing values 0 median : replace missing values global median per protein median_half : replace missing values 1/2 global median per protein mean: replace missing values global mean per protein group_mean: replace missing values mean per group, e.g. group (example: ROI) protein knn: imputation based k-nearest neighbors, proteins neighbors, based data samples across groups. NOTE: still NA values protein expressed group. group_knn: imputation based k-nearest neighbors, proteins neighbors, based data specified group (e.g. ROI, tissue). NOTE: still NA values protein expressed group. spatial_knn: imputation based k-nearest neighors space","code":""},{"path":"/reference/impute_spe.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Impute missing values based on spatial coordinates — impute_spe","text":"","code":"data(pancMeta) data(protMeta) data(smallPancData) # We can put all samples into the same object (for statistical power) pooledData <- dplyr::bind_cols(smallPancData) pooled.panc.spe <- convert_to_spe(pooledData,   pancMeta,   protMeta,   feature_meta_colname = \"pancProts\",   sample_id = \"\" ) #> Spatial object created without spatial coordinate  #>          column names provided. Distance based analysis will not be enabled. #> Note: Only mapping metadata for 2986 features out of 3000 data points # we can try two imputation methods and compare the difference res <- impute_spe(pooled.panc.spe, method = \"mean\") res2 <- impute_spe(pooled.panc.spe, method = \"group_mean\",                    group_colname = \"Image\") mean(assay(res, \"imputed\") - assay(res2, \"imputed\"), na.rm = TRUE) #> [1] 0.003118943"},{"path":"/reference/oneKSoilsCoords.html","id":null,"dir":"Reference","previous_headings":"","what":"Soil sample coordinates for the sample information — oneKSoilsCoords","title":"Soil sample coordinates for the sample information — oneKSoilsCoords","text":"Soil sample coordinates sample information","code":""},{"path":"/reference/oneKSoilsCoords.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Soil sample coordinates for the sample information — oneKSoilsCoords","text":"","code":"oneKSoilsCoords"},{"path":"/reference/oneKSoilsCoords.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"Soil sample coordinates for the sample information — oneKSoilsCoords","text":"object class data.frame 127 rows 3 columns.","code":""},{"path":"/reference/oneKSoilsMeta.html","id":null,"dir":"Reference","previous_headings":"","what":"Soil samples from the 1000 soils project Row names indiciate KEGG Orthologs, Column names indicate locations Soil samples metadata for the sample information — oneKSoilsMeta","title":"Soil samples from the 1000 soils project Row names indiciate KEGG Orthologs, Column names indicate locations Soil samples metadata for the sample information — oneKSoilsMeta","text":"Soil samples 1000 soils project Row names indiciate KEGG Orthologs, Column names indicate locations Soil samples metadata sample information","code":""},{"path":"/reference/oneKSoilsMeta.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Soil samples from the 1000 soils project Row names indiciate KEGG Orthologs, Column names indicate locations Soil samples metadata for the sample information — oneKSoilsMeta","text":"","code":"oneKSoilsMeta"},{"path":"/reference/oneKSoilsMeta.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"Soil samples from the 1000 soils project Row names indiciate KEGG Orthologs, Column names indicate locations Soil samples metadata for the sample information — oneKSoilsMeta","text":"object class data.frame 142 rows 21 columns.","code":""},{"path":"/reference/pancMeta.html","id":null,"dir":"Reference","previous_headings":"","what":"Here is the data to be included in the spammR package — pancMeta","title":"Here is the data to be included in the spammR package — pancMeta","text":"Sample metadata pancData file.","code":""},{"path":"/reference/pancMeta.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Here is the data to be included in the spammR package — pancMeta","text":"","code":"pancMeta"},{"path":"/reference/pancMeta.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"Here is the data to be included in the spammR package — pancMeta","text":"object class data.frame 63 rows 15 columns.","code":""},{"path":"/reference/pancMeta.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Here is the data to be included in the spammR package — pancMeta","text":"panc paper","code":""},{"path":"/reference/protMeta.html","id":null,"dir":"Reference","previous_headings":"","what":"Protein metadata for general uniprot data, including the pancProts column for the panc data — protMeta","title":"Protein metadata for general uniprot data, including the pancProts column for the panc data — protMeta","text":"Protein metadata general uniprot data, including pancProts column panc data","code":""},{"path":"/reference/protMeta.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Protein metadata for general uniprot data, including the pancProts column for the panc data — protMeta","text":"","code":"protMeta"},{"path":"/reference/protMeta.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"Protein metadata for general uniprot data, including the pancProts column for the panc data — protMeta","text":"object class data.frame 6662 rows 6 columns.","code":""},{"path":"/reference/protMeta.html","id":"source","dir":"Reference","previous_headings":"","what":"Source","title":"Protein metadata for general uniprot data, including the pancProts column for the panc data — protMeta","text":"Uniprot","code":""},{"path":"/reference/retrieve_metaspace_data.html","id":null,"dir":"Reference","previous_headings":"","what":"Retrieve data objects from metaspace — retrieve_metaspace_data","title":"Retrieve data objects from metaspace — retrieve_metaspace_data","text":"retrieve_metaspace_dataCollects data http://metaspace2020.org project id returns SpatialExperiment object","code":""},{"path":"/reference/retrieve_metaspace_data.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Retrieve data objects from metaspace — retrieve_metaspace_data","text":"","code":"retrieve_metaspace_data(   project_id = \"2024-02-15_20h37m13s\",   fdr = 0.2,   assay_name = \"lipids\",   sample_id = \"sample\",   rotate = FALSE,   drop_zeroes = TRUE,   y_offset = 0,   x_offset = 0 )"},{"path":"/reference/retrieve_metaspace_data.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Retrieve data objects from metaspace — retrieve_metaspace_data","text":"project_id Identifier project fdr FDR value collect data assay_name Name assay include object sample_id Name sample rotate Set TRUE x y coordinates need swapped drop_zeroes Set TRUE drop zeroes set values NAs. False zeroes included image data. y_offset Number pixels adjust y based image x_offset Number pixels adjust x based image","code":""},{"path":"/reference/retrieve_metaspace_data.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Retrieve data objects from metaspace — retrieve_metaspace_data","text":"SpatialExperiment object metaspace data coordinates.","code":""},{"path":"/reference/retrieve_metaspace_data.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Retrieve data objects from metaspace — retrieve_metaspace_data","text":"relies underlying python code environment run, including metaspace2020 package, numpy package, pandas package.","code":""},{"path":"/reference/retrieve_metaspace_data.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Retrieve data objects from metaspace — retrieve_metaspace_data","text":"","code":"# \\donttest{ rdat <- retrieve_metaspace_data(project_id = \"2024-02-15_20h37m13s\",                                 fdr = 0.2,                                 assay_name = 'lipids',                                sample_id = 'sample') #> Downloading ion data from metaspace... #> Warning: index contains duplicated values: row names not set head(rowMeans(assay(rdat,'lipids'))) #> C46H78NO10P-H-  C47H83O13P-H-    C20H32O2-H-    C22H32O2-H-    C16H30O2-H-  #>             NA             NA             NA             NA             NA  #> C42H80NO10P-H-  #>             NA  # }"},{"path":"/reference/smallPancData.html","id":null,"dir":"Reference","previous_headings":"","what":"Pancreatic proteomics measurements from Gosline et al. proteomics study. Row names indicate individual proteins, columns indicate sample identifiers described in pancMeta. Individual values show un-transformed abundance values for each protein. List of proteomic measurements in a list sorted from individual regions of the pancreas. A subset of the data at https://figshare.com/articles/dataset/spammR_Files/29250962 — smallPancData","title":"Pancreatic proteomics measurements from Gosline et al. proteomics study. Row names indicate individual proteins, columns indicate sample identifiers described in pancMeta. Individual values show un-transformed abundance values for each protein. List of proteomic measurements in a list sorted from individual regions of the pancreas. A subset of the data at https://figshare.com/articles/dataset/spammR_Files/29250962 — smallPancData","text":"Pancreatic proteomics measurements Gosline et al. proteomics study. Row names indicate individual proteins, columns indicate sample identifiers described pancMeta. Individual values show un-transformed abundance values  protein. List proteomic measurements list sorted individual regions pancreas. subset data https://figshare.com/articles/dataset/spammR_Files/29250962","code":""},{"path":"/reference/smallPancData.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Pancreatic proteomics measurements from Gosline et al. proteomics study. Row names indicate individual proteins, columns indicate sample identifiers described in pancMeta. Individual values show un-transformed abundance values for each protein. List of proteomic measurements in a list sorted from individual regions of the pancreas. A subset of the data at https://figshare.com/articles/dataset/spammR_Files/29250962 — smallPancData","text":"","code":"smallPancData"},{"path":"/reference/smallPancData.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"Pancreatic proteomics measurements from Gosline et al. proteomics study. Row names indicate individual proteins, columns indicate sample identifiers described in pancMeta. Individual values show un-transformed abundance values for each protein. List of proteomic measurements in a list sorted from individual regions of the pancreas. A subset of the data at https://figshare.com/articles/dataset/spammR_Files/29250962 — smallPancData","text":"object class list length 3.","code":""},{"path":"/reference/smallPancData.html","id":"source","dir":"Reference","previous_headings":"","what":"Source","title":"Pancreatic proteomics measurements from Gosline et al. proteomics study. Row names indicate individual proteins, columns indicate sample identifiers described in pancMeta. Individual values show un-transformed abundance values for each protein. List of proteomic measurements in a list sorted from individual regions of the pancreas. A subset of the data at https://figshare.com/articles/dataset/spammR_Files/29250962 — smallPancData","text":"panc paper","code":""},{"path":"/reference/spat_reduce.html","id":null,"dir":"Reference","previous_headings":"","what":"Reduce a high resolution image measurement (origin) to a lower resolution measurement (target) — spat_reduce","title":"Reduce a high resolution image measurement (origin) to a lower resolution measurement (target) — spat_reduce","text":"spat_reduce() Creates single SpatialExperiment object measurements mapped coordinate space plotting analysis","code":""},{"path":"/reference/spat_reduce.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Reduce a high resolution image measurement (origin) to a lower resolution measurement (target) — spat_reduce","text":"","code":"spat_reduce(   spe_target,   spe_origin,   origin_assay = \"lipids\",   target_dims = c(\"spot_width\", \"spot_height\"),   replace_nas = FALSE,   stat = \"mean\" )"},{"path":"/reference/spat_reduce.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Reduce a high resolution image measurement (origin) to a lower resolution measurement (target) — spat_reduce","text":"spe_target Low resolution image measurements spe_origin High-resolution image measurements mapped target origin_assay Name assay origin assay reduced target_dims Names width height target spots, respectively replace_nas Set TRUE want replace NA values zeroes. increase number data points common correlation calculations. stat Statistic used summarize regions, choices currently 'mean' 'median'","code":""},{"path":"/reference/spat_reduce.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Reduce a high resolution image measurement (origin) to a lower resolution measurement (target) — spat_reduce","text":"copy spe_target object altExp slot containing reduced version origin","code":""},{"path":"/reference/spat_reduce.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Reduce a high resolution image measurement (origin) to a lower resolution measurement (target) — spat_reduce","text":"function allows us map two distinct omics measurements coordinate system. takes 'origin' measurement summarizes values (typically via mean) ROI 'target' measurement source target values can compared.","code":""},{"path":"/reference/spatial_heatmap.html","id":null,"dir":"Reference","previous_headings":"","what":"Plot data in heatmap together with image — spatial_heatmap","title":"Plot data in heatmap together with image — spatial_heatmap","text":"spatial_heatmap() Creates spatial heatmap given feature SpatialExperiment object (spe) provides option label sample x-y plane","code":""},{"path":"/reference/spatial_heatmap.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Plot data in heatmap together with image — spatial_heatmap","text":"","code":"spatial_heatmap(   spe,   feature,   feature_type = NA,   assay_name = \"proteomics\",   plotBackground_img = TRUE,   sample_id,   image_id,   spatial_coord_type = \"\",   spot_size_name = c(\"spot_width\", \"spot_height\"),   metric_display = \"Protein expression\",   plot_log = FALSE,   label_column = NA,   fill_colors = c(\"slateblue\", \"darkgreen\", \"goldenrod\"),   sample_label_color = \"white\",   sample_label_size = 1.75,   plot_title = NULL,   title_size = 10,   show_na = FALSE,   interactive = FALSE )"},{"path":"/reference/spatial_heatmap.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Plot data in heatmap together with image — spatial_heatmap","text":"spe SpatialExperiment (SPE) object feature Name feature spe object whose values plotted spatial heat map. row name rowData(spe) feature_type Example: \"GeneName\". Default whatever identifier used rownames. name feature_type must present column rowData(spe) assay_name Name assay spe object contains data plotted plotBackground_img Boolean (TRUE FALSE) indicate whether background image plotted. Default FALSE. TRUE, parameters image_boundaries image_sample_id must specified, image data must present spe object, imgData(spe) sample_id names background image's sample_id fields spe object; provides unique identifier background image used plotting (multiple images imgData(spe)) plots samples associated specified image sample_id. Example: c(\"Image0\",\"Raw_noMarkings\"). Image data stored spe object can viewed imgData(spe) image_id name background image image_id. Together sample_id provides unique imge plot. spatial_coord_type Position type given spatial coordinates samples spe. Current options : \"topleft_corner\", \"topright_corner\". Default blank, assumes coordinates bottom right. spot_size_name vector length 2 describing columns find width height spot. metric_display Legend title spatial heatmap. parameter specified, legend title defaults \"Protein expression\" plot_log Boolean indicate data log-transformed plotting. Defaults FALSE label_column Column colData(spe) used labeling grid squares. specified, default labels. fill_colors List colors use provide gradient heatmap plotting sample_label_color Color used labels samples/grid squares. Default white. sample_label_size Font size sample labels. Default 1.75. plot_title Title given spatial heatmap. Default \"Spatial signature XYZ\" XYZ name specified feature title_size Font size title show_na Set TRUE want plot NA values (grey) otherwise plotted interactive Boolean value (TRUE/FALSE) indicating whether plot interactive mouse hovering. specified, defaults TRUE. Note: grid squares can labeled interactive = FALSE due current ggplotly limitations.","code":""},{"path":"/reference/spatial_heatmap.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Plot data in heatmap together with image — spatial_heatmap","text":"spatial heatmap chosen feature","code":""},{"path":"/reference/spatial_heatmap.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Plot data in heatmap together with image — spatial_heatmap","text":"Assumes every sample (column) assay(spe) corresponding x,y coordinate given spatialCoords(spe) Assumes colData(spe) spatialCoords(spe) provided order samples (rows). Assumes spe object contains background image data, stored imgData(spe) plotBackground_img specified TRUE . Default values specified function parameters 'metric_display', 'label_column' 'interactive,' user specify . Future versions spatialPlot_feature() include additional options spatial_coord_type: \"center\", bottomleft_corner\", \"bottomright_corner\"","code":""},{"path":"/reference/spatial_heatmap.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Plot data in heatmap together with image — spatial_heatmap","text":"","code":"data(pancMeta) data(smallPancData) data(protMeta) img0.spe <- convert_to_spe(smallPancData$Image_0,   pancMeta,   protMeta,   feature_meta_colname = \"pancProts\",   image_files = system.file(\"extdata\", \"Image_0.png\", package = \"spammR\"),   spatial_coords_colnames = c(\"x_pixels\", \"y_pixels\"),   sample_id = \"Image0\",   image_ids = \"with_grid\" ) #> Note: Only mapping metadata for 2986 features out of 3000 data points res = spatial_heatmap(img0.spe,         feature='INS',         sample_id='Image0',         image_id='with_grid',         feature_type='PrimaryGeneName',         label_column='IsletOrNot', interactive=FALSE)"},{"path":"/reference/spatial_network.html","id":null,"dir":"Reference","previous_headings":"","what":"Plot network of correlated features — spatial_network","title":"Plot network of correlated features — spatial_network","text":"spatial_network() Creates network given SpatialExperiment object (spe) based correlation features. return fully connect graph","code":""},{"path":"/reference/spatial_network.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Plot network of correlated features — spatial_network","text":"","code":"spatial_network(   spe,   assay_names,   feature_names = NULL,   query_features = NULL,   target_features = list(),   method = \"spearman\" )"},{"path":"/reference/spatial_network.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Plot network of correlated features — spatial_network","text":"spe SpatialExperiment (SPE) object assay_names Name assay spe object contains data plotted. one focus features first assay. one compute correlations across features. feature_names describe value use node names. missing use rownames query_features List features query correlation. target_featres build network feature nodes. missing, correlation computed nodes target_features. target_features List features compute correlation across. query_features NULL, compute correlation features query_features. Otherwise, compute correlation features list. DEFAULT: features spe. method use correlation, default spearman","code":""},{"path":"/reference/spatial_network.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Plot network of correlated features — spatial_network","text":"tidygraph object can used plotting analysis","code":""},{"path":"/reference/spatial_network.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Plot network of correlated features — spatial_network","text":"Using feature values, algorithm computes correlation across space, filtes lowest_thresh (interest compute time) selects correlated edges using top_edges parameter. largest connected component plotted, entire graph returned tidygraph object.","code":""},{"path":"/reference/spatial_network.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Plot network of correlated features — spatial_network","text":"","code":"data(pancMeta) data(smallPancData) data(protMeta) img0.spe <- convert_to_spe(smallPancData$Image_0,   pancMeta,   protMeta,   feature_meta_colname = \"pancProts\",   image_files = system.file(\"extdata\", \"Image_0.png\", package = \"spammR\"),   spatial_coords_colnames = c(\"x_pixels\", \"y_pixels\"),   sample_id = \"Image0\",   image_ids = \"with_grid\" ) #> Note: Only mapping metadata for 2986 features out of 3000 data points #get 10 most variable features vp <- sort(apply(assay(img0.spe),1,var),decreasing = TRUE)[1:10] ##now call the network res <- spatial_network(img0.spe,'proteomics', target_features=names(vp)) #> Joining with `by = join_by(rowval)`"},{"path":"/reference/split_spe.html","id":null,"dir":"Reference","previous_headings":"","what":"Divide SPE object into smaller objects by column features — split_spe","title":"Divide SPE object into smaller objects by column features — split_spe","text":"split_spe() splits SPE object smaller objects column feature. Ideally SpatialExperiment class utility package.","code":""},{"path":"/reference/split_spe.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Divide SPE object into smaller objects by column features — split_spe","text":"","code":"split_spe(spe, split_colname, assay_name = NULL)"},{"path":"/reference/split_spe.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Divide SPE object into smaller objects by column features — split_spe","text":"spe SpatialExperiment object containing spatial omics data spatial diffex results split_colname Column rowData maps gene set assay_name Optional name assay use split data","code":""},{"path":"/reference/split_spe.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Divide SPE object into smaller objects by column features — split_spe","text":"list SpatialExperiment objects containing subset data","code":""},{"path":"/reference/split_spe.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Divide SPE object into smaller objects by column features — split_spe","text":"","code":"data(smallPancData) data(pancMeta) data(protMeta) pooledPanc <- dplyr::bind_cols(smallPancData) panc.spe <- convert_to_spe(pooledPanc, pancMeta, protMeta,            feature_meta_colname = \"pancProts\") #> Spatial object created without spatial coordinate  #>          column names provided. Distance based analysis will not be enabled. #> Note: Only mapping metadata for 2986 features out of 3000 data points split_list <- split_spe(panc.spe, split_colname = \"Image\") #> Spatial object created without spatial coordinate  #>          column names provided. Distance based analysis will not be enabled. #> Spatial object created without spatial coordinate  #>          column names provided. Distance based analysis will not be enabled. #> Spatial object created without spatial coordinate  #>          column names provided. Distance based analysis will not be enabled."},{"path":"/reference/volcano_plot.html","id":null,"dir":"Reference","previous_headings":"","what":"Create a volcano plot from differential expression data — volcano_plot","title":"Create a volcano plot from differential expression data — volcano_plot","text":"volcano_plot() generates volcano plot visualize results differential expression analysis stored data frame. Use function directly differential expression results separate data frame spe object Helper function volcanoPlot_DiffExSpe.R; use volcanoPlot_DiffExSpe.R differential expression results spe object. -log10(p-value) vs. log2(fold change)","code":""},{"path":"/reference/volcano_plot.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Create a volcano plot from differential expression data — volcano_plot","text":"","code":"volcano_plot(   diffex.spe,   logFC_colname,   pval_colname,   pval_corrected = TRUE,   log_transformed = TRUE,   title,   thresh = 0.05,   sigLabel_colname )"},{"path":"/reference/volcano_plot.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Create a volcano plot from differential expression data — volcano_plot","text":"diffex.spe SpatialExperiment object containing differentail expression results rowData logFC_colname column name differenital expression results represents log10 fold change pval_colname column name differential epxression results represents p-value plotted pval_corrected Boolean indicating whether pval_colname represents corrected p-value log_transformed set TRUE data log transformed title title plot thresh Threshold p-value used annotate significant results plot sigLabel_colname Either vector labels string (Example: \"Gene\") column name differential expression results used labeling significant results plot.","code":""},{"path":"/reference/volcano_plot.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Create a volcano plot from differential expression data — volcano_plot","text":"ggplot Volcano plot","code":""},{"path":"/reference/volcano_plot.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Create a volcano plot from differential expression data — volcano_plot","text":"","code":"data(smallPancData) data(pancMeta) data(protMeta) pooledData <- dplyr::bind_cols(smallPancData) pooled.panc.spe <- convert_to_spe(pooledData,   pancMeta,   protMeta,   feature_meta_colname = \"pancProts\",   sample_id = \"\" ) #> Spatial object created without spatial coordinate  #>          column names provided. Distance based analysis will not be enabled. #> Note: Only mapping metadata for 2986 features out of 3000 data points diffex.spe <- calc_spatial_diff_ex(pooled.panc.spe,   category_col = \"IsletOrNot\" ) #> Warning: Partial NA coefficients for 2 probe(s) #> We found 0 features with a logFC greater than 1 and  #>                  an ajusted p-value less than 0.05 volcano_plot(diffex.spe,   sigLabel_colname = \"PrimaryGeneName\",   title = \"Islet vs nonIslet\" ) #> Warning: Removed 2 rows containing missing values or values outside the scale range #> (`geom_point()`). #> Warning: Removed 2 rows containing missing values or values outside the scale range #> (`geom_text_repel()`). #> Warning: ggrepel: 447 unlabeled data points (too many overlaps). Consider increasing max.overlaps"},{"path":"/news/index.html","id":"spammr-0990","dir":"Changelog","previous_headings":"","what":"spammR 0.99.0","title":"spammR 0.99.0","text":"Initial Bioconductor submission.","code":""}]
